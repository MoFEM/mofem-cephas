/* Parallel Hierarchical Grid -- an adaptive finite element library.
 *
 * Copyright (C) 2005-2010 State Key Laboratory of Scientific and
 * Engineering Computing, Chinese Academy of Sciences. */

/* This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
 * MA  02110-1301  USA */

/* $Id: quad.c,v 1.229 2015/10/09 06:33:18 zlb Exp $ */

/* Numerical Quadrature */

#include <stdio.h>
#include <stdlib.h>

# define _F(n)	n		/* no suffix */
#define FALSE 0
#define TRUE 1

inline void phgFree(void *ptr) {
  free(ptr);
}
inline void* phgAlloc(size_t size) {
  return malloc(size);
}
inline void* phgRealloc_(
  void *ptr,size_t size,size_t size_old
) {
  return realloc(ptr,size);
}

#include "quad.h"
#include "quad-permu.h"
#include <math.h>
#include <stdlib.h>
#include <string.h>

#ifdef Length
# undef Length
#endif
#define Length(wts)	(sizeof(wts) / (sizeof(wts[0])))

typedef QUAD *(*QGEN_FUNC) (int dim, int order);

void
phgQuadFree(QUAD **quad)
{
    if ((*quad) == NULL)
	return;
    phgFree((*quad)->name);
    phgFree((*quad)->points);
    phgFree((*quad)->weights);
    phgFree((*quad));

    *quad = NULL;
}

static void
init_table(int n0, QUAD **table0, int *n, QUAD ***table)
{
#if USE_OMP
#pragma omp critical (init_table)
#endif	/* USE_OMP */
    if (*table == NULL) {
	void *p = phgAlloc(n0 * sizeof(*table0));
	memcpy(p, table0, n0 * sizeof(*table0));
	*n = n0;
	*table = p;
    }
}

#define nquad0	(sizeof(table0) / sizeof(*table0))
#define GetQuadrature(qgen_func) {					\
    static int nquad;							\
    static QUAD **table = NULL;						\
    static char warned = FALSE;					\
									\
    if (order < 0) {							\
	/* free dynamically generated quadrature rules */		\
	if (table != NULL) {						\
	    int i, j;							\
	    for (i = nquad0; i < nquad; i++) {				\
		for (j = i + 1; j < nquad && table[j] == table[i]; j++)	\
		    table[j] = NULL;					\
		phgQuadFree(&table[i]);					\
	    }								\
	    phgFree(table);						\
	    table = NULL;						\
	}								\
	return NULL;							\
    }									\
    if (table == NULL) {						\
	/* initialization */						\
	init_table(nquad0, table0, &nquad, &table);			\
    }									\
    if (order >= nquad) {						\
	if (/*qgen_func == NULL*/FALSE) {				\
	    if (!warned) {				\
		printf("%dD quad rule of order %d unavailable.\n",	\
				table[0]->dim, order);			\
		warned = TRUE;						\
	    }								\
	    order = nquad - 1;						\
	}								\
	else {								\
	    if (qgen_func == phgQuadTensorProductRule)			\
		order = (order / 2) * 2	+ 1;				\
	    table = phgRealloc_(table, (order + 1) * sizeof(*table),	\
					nquad * sizeof(*table));	\
	    memset(table + nquad, 0, (order - nquad + 1) * sizeof(*table)); \
	    nquad = order + 1;						\
	}								\
    }									\
    if (table[order] == NULL) {						\
	if (FALSE && table[0]->dim > 1) {		\
	    printf("using %dD-%d tensor product quadrature rule.\n",\
			table[0]->dim, order);				\
	}								\
	table[order] = (qgen_func)(table[0]->dim, order);		\
	if (order > nquad0 && qgen_func == phgQuadTensorProductRule)	\
	    table[order - 1] = table[order];				\
    }									\
    return table[order];						\
}

QUAD *
phgQuadGetQuad1D(int order)
{
    /* Table of static 1D quadrature rules */
    static QUAD *table0[] = { QUAD_1D_P1,
	QUAD_1D_P1,	QUAD_1D_P2,	QUAD_1D_P3,
	QUAD_1D_P4,	QUAD_1D_P5,	QUAD_1D_P6,
	QUAD_1D_P7,	QUAD_1D_P8,	QUAD_1D_P9,
	QUAD_1D_P10,	QUAD_1D_P11,	QUAD_1D_P12,
	QUAD_1D_P13,	QUAD_1D_P14,	QUAD_1D_P15,
	QUAD_1D_P16,	QUAD_1D_P17,	QUAD_1D_P18,
	QUAD_1D_P19,	QUAD_1D_P20,	QUAD_1D_P21
    };
    GetQuadrature(phgQuadTensorProductRule)
}

QUAD *
phgQuadGetQuad2D(int order)
{
    /* Table of static 2D quadrature rules */
    static QUAD *table0[] = { QUAD_2D_P1,
	QUAD_2D_P1,	QUAD_2D_P2,	QUAD_2D_P3,	QUAD_2D_P4,
	QUAD_2D_P5,	QUAD_2D_P6,	QUAD_2D_P7,	QUAD_2D_P8,
	QUAD_2D_P9,	QUAD_2D_P10,	QUAD_2D_P11,	QUAD_2D_P12,
	QUAD_2D_P13,	QUAD_2D_P14,	QUAD_2D_P15,	QUAD_2D_P16,
	QUAD_2D_P17,	QUAD_2D_P18,	QUAD_2D_P19,	QUAD_2D_P20,
	QUAD_2D_P21,	QUAD_2D_P22,	QUAD_2D_P23,	QUAD_2D_P24,
	QUAD_2D_P25,	QUAD_2D_P26,	QUAD_2D_P27,	QUAD_2D_P28,
	QUAD_2D_P29
    };
    GetQuadrature(phgQuadTensorProductRule)
}

QUAD *
phgQuadGetQuad3D(int order)
{
    /* Table of static 3D quadrature (cubature) rules */
    static QUAD *table0[] = { QUAD_3D_P1,
	QUAD_3D_P1,	QUAD_3D_P2,	QUAD_3D_P3,	QUAD_3D_P4,
	QUAD_3D_P5,	QUAD_3D_P6,	QUAD_3D_P7,	QUAD_3D_P8,
	QUAD_3D_P9,	QUAD_3D_P10,	QUAD_3D_P11,	QUAD_3D_P12,
	QUAD_3D_P13,	QUAD_3D_P14
    };
    GetQuadrature(phgQuadTensorProductRule)
}

/*--------------------------- 1D quadrature rules ------------------------*/

static double QUAD_1D_P1_wts[] = {
    Dup2(1.)
};
static double QUAD_1D_P1_pts[Length(QUAD_1D_P1_wts) * 2] = {
    Perm2(.5)
};
QUAD QUAD_1D_P1_ = {
    "1D P1",			/* name */
    1,				/* dim */
    1,				/* order */
    Length(QUAD_1D_P1_wts),	/* npoints */
    QUAD_1D_P1_pts,		/* points */
    QUAD_1D_P1_wts,		/* weights */
    -1				/* id */
};

static double QUAD_1D_P3_wts[] = {
    Dup11(.5)
};
static double QUAD_1D_P3_pts[Length(QUAD_1D_P3_wts) * 2] = {
    /* (3 - sqrt(3)) / 6, (3 + sqrt(3)) / 6 */
    Perm11(.21132486540518711774542560974902127)
};
QUAD QUAD_1D_P3_ = {
    "1D P3",			/* name */
    1,				/* dim */
    3,				/* order */
    Length(QUAD_1D_P3_wts),	/* npoints */
    QUAD_1D_P3_pts,		/* points */
    QUAD_1D_P3_wts,		/* weights */
    -1				/* id */
};

static double QUAD_1D_P5_wts[] = {
    Dup11(5./18.),
    Dup2(4./9.)
};
static double QUAD_1D_P5_pts[Length(QUAD_1D_P5_wts) * 2] = {
    /* (5 - sqrt(15)) / 10, 1 / 2, (5 + sqrt(15)) / 10 */
    Perm11(.11270166537925831148207346002176004),
    Perm2(.5)
};
QUAD QUAD_1D_P5_ = {
    "1D P5",			/* name */
    1,				/* dim */
    5,				/* order */
    Length(QUAD_1D_P5_wts),	/* npoints */
    QUAD_1D_P5_pts,		/* points */
    QUAD_1D_P5_wts,		/* weights */
    -1				/* id */
};

static double QUAD_1D_P7_wts[] = {
    /* (18 - sqrt(30)) / 72, (18 + sqrt(30)) / 72 */
    Dup11(.17392742256872692868653197461099970),
    Dup11(.32607257743127307131346802538900030)
};
static double QUAD_1D_P7_pts[Length(QUAD_1D_P7_wts) * 2] = {
    /* (35 \pm sqrt(525 \pm 70 * sqrt(30))) / 70 */
    Perm11(.06943184420297371238802675555359525),
    Perm11(.33000947820757186759866712044837766)
};
QUAD QUAD_1D_P7_ = {
    "1D P7",			/* name */
    1,				/* dim */
    7,				/* order */
    Length(QUAD_1D_P7_wts),	/* npoints */
    QUAD_1D_P7_pts,		/* points */
    QUAD_1D_P7_wts,		/* weights */
    -1				/* id */
};

static double QUAD_1D_P9_wts[] = {
    /* (322 \pm 13 * sqrt(70)) / 1800 */
    Dup2(128./450.),
    Dup11(.11846344252809454375713202035995868),
    Dup11(.23931433524968323402064575741781910)
};
static double QUAD_1D_P9_pts[Length(QUAD_1D_P9_wts) * 2] = {
    /* (21 \pm sqrt(245 \pm 14 * sqrt(70))) / 42 */
    Perm2(0.5),
    Perm11(.04691007703066800360118656085030352),
    Perm11(.23076534494715845448184278964989560)
};
QUAD QUAD_1D_P9_ = {
    "1D P9",			/* name */
    1,				/* dim */
    9,				/* order */
    Length(QUAD_1D_P9_wts),	/* npoints */
    QUAD_1D_P9_pts,		/* points */
    QUAD_1D_P9_wts,		/* weights */
    -1				/* id */
};

static double QUAD_1D_P11_wts[] = {
    Dup11(.08566224618958517252014807108636645),
    Dup11(.18038078652406930378491675691885806),
    Dup11(.23395696728634552369493517199477550)
};
static double QUAD_1D_P11_pts[Length(QUAD_1D_P11_wts) * 2] = {
    Perm11(.96623475710157601390615077724699730),
    Perm11(.83060469323313225683069979750995267),
    Perm11(.61930959304159845431525086084035597)
};
QUAD QUAD_1D_P11_ = {
    "1D P11",			/* name */
    1,				/* dim */
    11,				/* order */
    Length(QUAD_1D_P11_wts),	/* npoints */
    QUAD_1D_P11_pts,		/* points */
    QUAD_1D_P11_wts,		/* weights */
    -1				/* id */
};

static double QUAD_1D_P13_wts[] = {
    Dup11(.06474248308443484663530571633954101),
    Dup11(.13985269574463833395073388571188979),
    Dup11(.19091502525255947247518488774448757),
    Dup2(.20897959183673469387755102040816327)
};
static double QUAD_1D_P13_pts[Length(QUAD_1D_P13_wts) * 2] = {
    Perm11(.97455395617137926226309484202392563),
    Perm11(.87076559279969721993193238664039420),
    Perm11(.70292257568869858345330320603848073),
    Perm2(.5)
};
QUAD QUAD_1D_P13_ = {
    "1D P13",			/* name */
    1,				/* dim */
    13,				/* order */
    Length(QUAD_1D_P13_wts),	/* npoints */
    QUAD_1D_P13_pts,		/* points */
    QUAD_1D_P13_wts,		/* weights */
    -1				/* id */
};

static double QUAD_1D_P15_wts[] = {
    Dup11(.05061426814518812957626567715498110),
    Dup11(.11119051722668723527217799721312044),
    Dup11(.15685332293894364366898110099330066),
    Dup11(.18134189168918099148257522463859781)
};
static double QUAD_1D_P15_pts[Length(QUAD_1D_P15_wts) * 2] = {
    Perm11(.98014492824876811584178043428473650),
    Perm11(.89833323870681336979577696823791522),
    Perm11(.76276620495816449290886952459462317),
    Perm11(.59171732124782490246973807118009199)
};
QUAD QUAD_1D_P15_ = {
    "1D P15",		/* name */
    1,			/* dim */
    15,			/* order */
    Length(QUAD_1D_P15_wts),	/* npoints */
    QUAD_1D_P15_pts,	/* points */
    QUAD_1D_P15_wts,	/* weights */
    -1			/* id */
};

static double QUAD_1D_P17_wts[] = {
    Dup11(.04063719418078720598594607905526183),
    Dup11(.09032408034742870202923601562145640),
    Dup11(.13030534820146773115937143470931642),
    Dup11(.15617353852000142003431520329222183),
    Dup2(.16511967750062988158226253464348702)
};
static double QUAD_1D_P17_pts[Length(QUAD_1D_P17_wts) * 2] = {
    Perm11(.98408011975381304491778810145183644),
    Perm11(.91801555366331789714971489403486744),
    Perm11(.80668571635029519865435101967073709),
    Perm11(.66212671170190446451926900732166830),
    Perm2(.5)
};
QUAD QUAD_1D_P17_ = {
    "1D P17",		/* name */
    1,			/* dim */
    17,			/* order */
    Length(QUAD_1D_P17_wts),	/* npoints */
    QUAD_1D_P17_pts,	/* points */
    QUAD_1D_P17_wts,	/* weights */
    -1			/* id */
};

static double QUAD_1D_P19_wts[] = {
    Dup11(.03333567215434406879678440494666590),
    Dup11(.07472567457529029657288816982884867),
    Dup11(.10954318125799102199776746711408160),
    Dup11(.13463335965499817754561346078473468),
    Dup11(.14776211235737643508694649732566916)
};
static double QUAD_1D_P19_pts[Length(QUAD_1D_P19_wts) * 2] = {
    Perm11(.98695326425858586003898200604222603),
    Perm11(.93253168334449225536604834421174652),
    Perm11(.83970478414951220311716368255743679),
    Perm11(.71669769706462359539963297158289208),
    Perm11(.57443716949081560544241300056485999)
};
QUAD QUAD_1D_P19_ = {
    "1D P19",		/* name */
    1,			/* dim */
    19,			/* order */
    Length(QUAD_1D_P19_wts),	/* npoints */
    QUAD_1D_P19_pts,	/* points */
    QUAD_1D_P19_wts,	/* weights */
    -1			/* id */
};

static double QUAD_1D_P21_wts[] = {
    Dup11(.02783428355808683324137686022127429),
    Dup11(.06279018473245231231734714961197005),
    Dup11(.09314510546386712571304882071582795),
    Dup11(.11659688229599523995926185242158757),
    Dup11(.13140227225512333109034443494525460),
    Dup2(.13646254338895031535724176416817109)
};
static double QUAD_1D_P21_pts[Length(QUAD_1D_P21_wts) * 2] = {
    Perm11(.98911432907302849640196900056142870),
    Perm11(.94353129988404764953757888465196363),
    Perm11(.86507600278702466204670812601557673),
    Perm11(.75954806460340590796286283472930478),
    Perm11(.63477157797617248616576599270043076),
    Perm2(.5)
};
QUAD QUAD_1D_P21_ = {
    "1D P21",		/* name */
    1,			/* dim */
    21,			/* order */
    Length(QUAD_1D_P21_wts),	/* npoints */
    QUAD_1D_P21_pts,	/* points */
    QUAD_1D_P21_wts,	/* weights */
    -1			/* id */
};

/*--------------------------- 2D cubature rules ------------------------*/

static double QUAD_2D_P1_wts[] = {
    Dup3(1.)
};
static double QUAD_2D_P1_pts[Length(QUAD_2D_P1_wts) * 3] = {
    Perm3(1./3.)
};
QUAD QUAD_2D_P1_ = {
    "2D P1",			/* name */
    2,				/* dim */
    1,				/* order */
    Length(QUAD_2D_P1_wts),	/* npoints = 1 */
    QUAD_2D_P1_pts,		/* points */
    QUAD_2D_P1_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P2_wts[] = {
    Dup21(1./3.)
};
static double QUAD_2D_P2_pts[Length(QUAD_2D_P2_wts) * 3] = {
    Perm21(1./6.)
};
QUAD QUAD_2D_P2_ = {
    "2D P2",			/* name */
    2,				/* dim */
    2,				/* order */
    Length(QUAD_2D_P2_wts),	/* npoints = 3 */
    QUAD_2D_P2_pts,		/* points */
    QUAD_2D_P2_wts,		/* weights */
    -1				/* id */
};

#if 0
/* Note: this rule has points on the edges */
static double QUAD_2D_P3_wts[] = {
    Dup21(1./30.),
    Dup21(3./10.)
};
static double QUAD_2D_P3_pts[Length(QUAD_2D_P3_wts) * 3] = {
    Perm21(.5),
    /* 1/6 */
    Perm21(1./6.)
};
#else
static double QUAD_2D_P3_wts[] = {
    Dup21(.28114980244097964825351432270207695),
    Dup21(.05218353089235368507981901063125638)
};
static double QUAD_2D_P3_pts[Length(QUAD_2D_P3_wts) * 3] = {
    Perm21(.16288285039589191090016180418490635),
    Perm21(.47791988356756370000000000000000000)
};
#endif
QUAD QUAD_2D_P3_ = {
    "2D P3",			/* name */
    2,				/* dim */
    3,				/* order */
    Length(QUAD_2D_P3_wts),	/* npoints = 6 */
    QUAD_2D_P3_pts,		/* points */
    QUAD_2D_P3_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P4_wts[] = {
    /* (620 + sqrt(213125 - 53320 * sqrt(10))) / 3720 */
    Dup21(.22338158967801146569500700843312280),
    /* (620 - sqrt(213125 - 53320 * sqrt(10))) / 3720 */
    Dup21(.10995174365532186763832632490021053)
};
static double QUAD_2D_P4_pts[Length(QUAD_2D_P4_wts) * 3] = {
    /* (8 - sqrt(10) + sqrt(38 - 44 * sqrt(2 / 5))) / 18 */
    Perm21(.44594849091596488631832925388305199),
    /* (8 - sqrt(10) - sqrt(38 - 44 * sqrt(2 / 5))) / 18 */
    Perm21(.09157621350977074345957146340220151)
};
QUAD QUAD_2D_P4_ = {
    "2D P4",			/* name */
    2,				/* dim */
    4,				/* order */
    Length(QUAD_2D_P4_wts),	/* npoints = 6 */
    QUAD_2D_P4_pts,		/* points */
    QUAD_2D_P4_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P5_wts[] = {
    /* (155 - sqrt(15)) / 1200 */
    Dup21(.12593918054482715259568394550018133),
    /* (155 + sqrt(15)) / 1200 */
    Dup21(.13239415278850618073764938783315200),
    Dup3(9./40.)
};
static double QUAD_2D_P5_pts[Length(QUAD_2D_P5_wts) * 3] = {
    /* (6 - sqrt(15)) / 21 */
    Perm21(.10128650732345633880098736191512383),
    /* (6 + sqrt(15)) / 21 */
    Perm21(.47014206410511508977044120951344760),
    /* 1 / 3 */
    Perm3(1./3.)
};
QUAD QUAD_2D_P5_ = {
    "2D P5",			/* name */
    2,				/* dim */
    5,				/* order */
    Length(QUAD_2D_P5_wts),	/* npoints = 7 */
    QUAD_2D_P5_pts,		/* points */
    QUAD_2D_P5_wts,		/* weights */
    -1				/* id */
};

#if 0
/* An 11-point unsymmetric rule reported in:
 *	 Day, David M., Mark A. Taylor, "A new 11 point degree 6 cubature
 *	 	formula for the triangle [Proceedings of the ICIAM 2007],"
 *	 Journal Article, Proceedings of Applied Mathematics and Mechanics,
 *	 Accepted/Published January 2008. */
static double QUAD_2D_P6_wts[] = {
    Dup0(.03806807185295551439063192528703396),
    Dup0(.03837935530775265554764109222240791),
    Dup0(.04620045674456241859455515980217997),
    Dup0(.05346758944419901689402679518609906),
    Dup0(.08375582696574588108371037842585680),
    Dup0(.10164483302551605906571229513115369),
    Dup0(.10186152446136717571450065716620939),
    Dup0(.11142183166000185684914076857474210),
    Dup0(.11200945026294611573462286906312035),
    Dup0(.12478757143755821156418716664966669),
    Dup0(.18840348883739509456127089249153007)
};
static double QUAD_2D_P6_pts[Length(QUAD_2D_P6_wts) * 3] = {
    Perm30(.05725498667747685254386401337490528,.89549814678987956946437486806257514),
    Perm30(.89536264002457947703053711751108844,.06182822125032174107784815639931401),
    Perm30(.68447574845651404000000000000000000,.02334373849768321288645813914257559),
    Perm30(.06874625591502945506138017629748138,.06003027574726303099667885025487684),
    Perm30(.61567620557584050877805946045395354,.33346180834137626773374382178966904),
    Perm30(.62794614119778946000000000000000000,.15918918599215148000000000000000000),
    Perm30(.06290913834186374714863309341182919,.65529509370545247000000000000000000),
    Perm30(.06837821192050999512347955121812458,.30911768542826747346974929569953382),
    Perm30(.28752945837439246626570898085589649,.63642650917962018000000000000000000),
    Perm30(.32878355641313448865307686080999177,.07702400564246333220945276738749036),
    Perm30(.31229040501364539638767631759216157,.35234478644589918332680050733851911)
};
QUAD QUAD_2D_P6_ = {
    "2D P6",			/* name */
    2,				/* dim */
    6,				/* order */
    Length(QUAD_2D_P6_wts),	/* npoints = 11 */
    QUAD_2D_P6_pts,		/* points */
    QUAD_2D_P6_wts,		/* weights */
    -1				/* id */
};
#else
static double QUAD_2D_P6_wts[] = {
    Dup21(.05084490637020681692093680910686898),
    Dup21(.11678627572637936602528961138557944),
    Dup111(.08285107561837357519355345642044245)
};
static double QUAD_2D_P6_pts[Length(QUAD_2D_P6_wts) * 3] = {
    Perm21(.06308901449150222834033160287081916),
    Perm21(.24928674517091042129163855310701908),
    Perm111(.05314504984481694735324967163139815,
	    .31035245103378440541660773395655215)
};
QUAD QUAD_2D_P6_ = {
    "2D P6",			/* name */
    2,				/* dim */
    6,				/* order */
    Length(QUAD_2D_P6_wts),	/* npoints = 12 */
    QUAD_2D_P6_pts,		/* points */
    QUAD_2D_P6_wts,		/* weights */
    -1				/* id */
};
#endif

#if 0
static double QUAD_2D_P7_wts[] = {
    Dup21(0.0102558174092),
    Dup111(0.1116047046647),
    Dup21(0.1679775595335),
    Dup21(0.2652238803946)
};
static double QUAD_2D_P7_pts[Length(QUAD_2D_P7_wts) * 3] = {
    Perm21(0.),
    Perm111(0.7839656651012, 0.1738960507345),
    Perm21(0.4743880861752),
    Perm21(0.2385615300181)
};
#else
static double QUAD_2D_P7_wts[] = {
    Dup21(.01353386251566556156682309245259393),
    Dup21(.07895125443201098137652145029770332),
    Dup21(.12860792781890607455665553308952344),
    Dup111(.05612014428337535791666662874675632)
};
static double QUAD_2D_P7_pts[Length(QUAD_2D_P7_wts) * 3] = {
    Perm21(.02826392415607634022359600691324002),
    Perm21(.47431132326722257527522522793181654),
    Perm21(.24114332584984881025414351267036207),
    Perm111(.76122274802452380000000000000000000,
	    .04627087779880891064092559391702049)
};
#endif
QUAD QUAD_2D_P7_ = {
    "2D P7",			/* name */
    2,				/* dim */
    7,				/* order */
    Length(QUAD_2D_P7_wts),	/* npoints = 15 */
    QUAD_2D_P7_pts,		/* points */
    QUAD_2D_P7_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P8_wts[] = {
    Dup3(.14431560767778716825109111048906462),
    Dup21(.10321737053471825028179155029212903),
    Dup21(.03245849762319808031092592834178060),
    Dup21(.09509163426728462479389610438858432),
    Dup111(.02723031417443499426484469007390892)
};
static double QUAD_2D_P8_pts[Length(QUAD_2D_P8_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.17056930775176020662229350149146450),
    Perm21(.05054722831703097545842355059659895),
    Perm21(.45929258829272315602881551449416932),
    Perm111(.26311282963463811342178578628464359,
	    .00839477740995760533721383453929445)
};
QUAD QUAD_2D_P8_ = {
    "2D P8",			/* name */
    2,				/* dim */
    8,				/* order */
    Length(QUAD_2D_P8_wts),	/* npoints = 16 */
    QUAD_2D_P8_pts,		/* points */
    QUAD_2D_P8_wts,		/* weights */
    -1				/* id */
};

#if 0
static double QUAD_2D_P9_wts[] = {
    Dup21(0.0519871420646),
    Dup111(0.0707034101784),
    Dup111(0.0909390760952),
    Dup21(0.1032344051380),
    Dup21(0.1881601469167)
};
static double QUAD_2D_P9_pts[Length(QUAD_2D_P9_wts) * 3] = {
    Perm21(0.0451890097844),
    Perm111(0.7475124727339, 0.2220631655373),
    Perm111(0.1369912012649, 0.2182900709714),
    Perm21(0.4815198347833),
    Perm21(0.4036039798179)
};
QUAD QUAD_2D_P9_ = {
    "2D P9",			/* name */
    2,				/* dim */
    9,				/* order */
    21,				/* npoints */
    QUAD_2D_P9_pts,		/* points */
    QUAD_2D_P9_wts,		/* weights */
    -1				/* id */
};
#else
static double QUAD_2D_P9_wts[] = {
    Dup3(.09713579628279883381924198250728863),
    Dup21(.03133470022713907053685483128720932),
    Dup21(.02557767565869803126167879855899982),
    Dup21(.07782754100477427931673935629940396),
    Dup21(.07964773892721025303289177426404527),
    Dup111(.04328353937728937728937728937728938)
};
static double QUAD_2D_P9_pts[Length(QUAD_2D_P9_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.48968251919873762778370692483619280),
    Perm21(.04472951339445270986510658996627636),
    Perm21(.43708959149293663726993036443535497),
    Perm21(.18820353561903273024096128046733557),
    Perm111(.74119859878449802069007987352342383,
	    .22196298916076569567510252769319107)
};
QUAD QUAD_2D_P9_ = {
    "2D P9",			/* name */
    2,				/* dim */
    9,				/* order */
    Length(QUAD_2D_P9_wts),	/* npoints = 19 */
    QUAD_2D_P9_pts,		/* points */
    QUAD_2D_P9_wts,		/* weights */
    -1				/* id */
};
#endif

static double QUAD_2D_P10_wts[] = {
    Dup3(.08093742879762288025711312381650193),
    Dup21(.07729858800296312168250698238034344),
    Dup21(.07845763861237173136809392083439673),
    Dup21(.01746916799592948691760716329067815),
    Dup21(.00429237418483282803048040209013191),
    Dup111(.03746885821046764297902076548504452),
    Dup111(.02694935259187995964544947958109671)
};
static double QUAD_2D_P10_pts[Length(QUAD_2D_P10_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.42727317884677553809044271751544715),
    Perm21(.18309922244867502052157438485022004),
    Perm21(.49043401970113058745397122237684843),
    Perm21(.01257244555158053273132908502104126),
    Perm111(.65426866792006614066657009558762790,
	    .30804600168524770000000000000000000),
    Perm111(.12280457706855927343012981748128116,
	    .03337183373930478624081644177478038)
};
QUAD QUAD_2D_P10_ = {
    "2D P10",			/* name */
    2,				/* dim */
    10,				/* order */
    Length(QUAD_2D_P10_wts),	/* npoints = 25 */
    QUAD_2D_P10_pts,		/* points */
    QUAD_2D_P10_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P11_wts[] = {
    Dup3(.08117796029686715951547596874982357),
    Dup21(.01232404350690949411847390101623284),
    Dup21(.06282800974441010728333942816029398),
    Dup21(.01222037904936452975521221500393789),
    Dup21(.06770134895281150992098886182322559),
    Dup21(.04021969362885169042356688960756866),
    Dup111(.01476227271771610133629306558778206),
    Dup111(.04072799645829903966033695848161786)
};
static double QUAD_2D_P11_pts[Length(QUAD_2D_P11_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.03093835524543078489519501499130475),
    Perm21(.43649818113412884191761527655997324),
    Perm21(.49898476370259326628798698383139087),
    Perm21(.21468819795859433660687581387825086),
    Perm21(.11368310404211339020529315622836178),
    Perm111(.82561876616486290435880620030835800,
	    .15974230459185018980086078822500751),
    Perm111(.64047231013486526767703659081896681,
	    .31178371570959900000000000000000000)
};
QUAD QUAD_2D_P11_ = {
    "2D P11",			/* name */
    2,				/* dim */
    11,				/* order */
    Length(QUAD_2D_P11_wts),	/* npoints = 28 */
    QUAD_2D_P11_pts,		/* points */
    QUAD_2D_P11_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P12_wts[] = {
    Dup21(.00616626105155901723386648378523035),
    Dup21(.06285822421788510035427051309288255),
    Dup21(.03479611293070894298932839729499937),
    Dup21(.04369254453803840213545726255747497),
    Dup21(.02573106644045533541779092307156443),
    Dup111(.02235677320230344571183907670231999),
    Dup111(.01731623110865889237164210081103407),
    Dup111(.04037155776638092951782869925223677)
};
static double QUAD_2D_P12_pts[Length(QUAD_2D_P12_wts) * 3] = {
    Perm21(.02131735045321037024685697551572825),
    Perm21(.27121038501211592234595134039689474),
    Perm21(.12757614554158592467389632515428357),
    Perm21(.43972439229446027297973662348436108),
    Perm21(.48821738977380488256466206525881104),
    Perm111(.69583608678780342214163552323607254,
	    .28132558098993954824813069297455275),
    Perm111(.85801403354407263059053661662617818,
	    .11625191590759714124135414784260182),
    Perm111(.60894323577978780685619243776371007,
	    .27571326968551419397479634607976398)
};
QUAD QUAD_2D_P12_ = {
    "2D P12",			/* name */
    2,				/* dim */
    12,				/* order */
    Length(QUAD_2D_P12_wts),	/* npoints = 33 */
    QUAD_2D_P12_pts,		/* points */
    QUAD_2D_P12_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P13_wts[] = {
    Dup3(.06796003658683164428177442468088488),
    Dup21(.05560196753045332870725746601046147),
    Dup21(.05827848511919998140476708351333981),
    Dup21(.00605233710353917184179280003229082),
    Dup21(.02399440192889473077371079945095965),
    Dup111(.03464127614084837046598682851091822),
    Dup111(.01496540110516566726324585713290344),
    Dup111(.02417903981159381913744574557306076),
    Dup111(.00959068100354326272259509016611089)
};
static double QUAD_2D_P13_pts[Length(QUAD_2D_P13_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.42694141425980040602081253503137421),
    Perm21(.22137228629183290065481255470507908),
    Perm21(.02150968110884318386929131353405208),
    Perm21(.48907694645253934990068971909020439),
    Perm111(.62354599555367557081585435318623659,
	    .30844176089211777465847185254124531),
    Perm111(.86470777029544277530254595089569318,
	    .11092204280346339541286954522167452),
    Perm111(.74850711589995219517301859578870965,
	    .16359740106785048023388790171095725),
    Perm111(.72235779312418796526062013230478405,
	    .27251581777342966618005046435408685)
};
QUAD QUAD_2D_P13_ = {
    "2D P13",			/* name */
    2,				/* dim */
    13,				/* order */
    Length(QUAD_2D_P13_wts),	/* npoints = 37 */
    QUAD_2D_P13_pts,		/* points */
    QUAD_2D_P13_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P14_wts[] = {
    Dup21(.04216258873699301753823043732418613),
    Dup21(.00492340360240008168182602350904215),
    Dup21(.01443369966977666760170992148065332),
    Dup21(.03278835354412535064131097873862534),
    Dup21(.02188358136942889064084494596332597),
    Dup21(.05177410450729158631478491016639640),
    Dup111(.02466575321256367396287524518363623),
    Dup111(.03857151078706068322848902781041086),
    Dup111(.01443630811353384049608869199901580),
    Dup111(.00501022883850067176986009308248912)
};
static double QUAD_2D_P14_pts[Length(QUAD_2D_P14_wts) * 3] = {
    Perm21(.17720553241254343695661069046505908),
    Perm21(.01939096124870104817825009505452951),
    Perm21(.06179988309087260126747882843693579),
    Perm21(.41764471934045392250944082218564344),
    Perm21(.48896391036217863867737602045239024),
    Perm21(.27347752830883865975494428326269856),
    Perm111(.17226668782135557837528960161365733,
	    .05712475740364793903567712421891471),
    Perm111(.57022229084668317349769621336235426,
	    .09291624935697182475824858954872035),
    Perm111(.29837288213625775297083151805961273,
	    .01464695005565440967054132792007421),
    Perm111(.11897449769695684539818196192990548,
	    .00126833093287202508724640109549269)
};
QUAD QUAD_2D_P14_ = {
    "2D P14",			/* name */
    2,				/* dim */
    14,				/* order */
    Length(QUAD_2D_P14_wts),	/* npoints = 42 */
    QUAD_2D_P14_pts,		/* points */
    QUAD_2D_P14_wts,		/* weights */
    -1				/* id */
};

/* a 49-point rule communicated by Freddie Witherden (freddie@witherden.org)
 * 2D 49 point order 15 rule (1:4:6, 346 tries, 3288 evals), error = 4.251e-17
 */
static double QUAD_2D_P15_wts[] = {
    Dup3(.02357126703190634206659321140821418),
    Dup21(.01517314955721170450311858877690239),
    Dup21(.01297600128392884154979521077280757),
    Dup21(.01706629596800615670942600046160914),
    Dup21(.04576001946273760698482638108892258),
    Dup111(.00222757447282223154006065426298478),
    Dup111(.02701014165986947101315702212247500),
    Dup111(.02608377963958756403057720483642768),
    Dup111(.01211015327702828337230795926322736),
    Dup111(.01564785059680444573399007149035058),
    Dup111(.03417088937929479242522512890637806)
};
static double QUAD_2D_P15_pts[Length(QUAD_2D_P15_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.11022229622834687297855264132259850),
    Perm21(.05197643301003435047003197947889073),
    Perm21(.49114565807532554119014945122395425),
    Perm21(.39315718888435884048226809785071794),
    Perm111(.03737440487572919066543605209836625,
	    .96251835223001214880811969560396873),
    Perm111(.24824877798467321198263980694374938,
	    .19316669854521416819773100288721521),
    Perm111(.20699402274830217740486528153682148,
	    .08689590883549962551575259619781217),
    Perm111(.14854110526954708137688902238435510,
	    .01743682539845430796259020511767948),
    Perm111(.30674237923596382376588728350286621,
	    .01749251095825766163254977051260599),
    Perm111(.36703198754220473278855469116984882,
	    .09034802175864556044634095119222305)
};
QUAD QUAD_2D_P15_ = {
    "2D P15",			/* name */
    2,				/* dim */
    15,				/* order */
    Length(QUAD_2D_P15_wts),	/* npoints = 49 */
    QUAD_2D_P15_pts,		/* points */
    QUAD_2D_P15_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P16_wts[] = {
    Dup3(.04802218868037709055183940458051988),
    Dup21(.01470910030680192710340364286186919),
    Dup21(.02954458654931925599530972679646409),
    Dup21(.02612501735108837749859756549171557),
    Dup21(.00278038735239000697500301613866207),
    Dup21(.03182177300053664950342729005594961),
    Dup21(.00864583434950965990117373416984893),
    Dup111(.01430033290449536514661642536825213),
    Dup111(.02784977720360082995222987342395349),
    Dup111(.00704167340663609756237018808928069),
    Dup111(.01789983825993372860177020907581078),
    Dup111(.02745820038434976307247003810091720),
    Dup111(.00729979693943176208411254408777766)
};
static double QUAD_2D_P16_pts[Length(QUAD_2D_P16_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.08179498313137387264146559311886101),
    Perm21(.16530060196977965062676193293355656),
    Perm21(.46859210534946138669460289729660561),
    Perm21(.01443881344541668261410895669566020),
    Perm21(.24178428539178335340689445929320769),
    Perm21(.49531034298776996406549508687740551),
    Perm111(.65051340266135229943114468484168666,
	    .33139974453708955658132316818259388),
    Perm111(.60401128149599703984940410303596702,
	    .30324716274994218504155217807834692),
    Perm111(.80216825757474166361686194781166705,
	    .18802805952123717344418211429398875),
    Perm111(.75650560644282839655115407575806082,
	    .18350466852229686368238027743700035),
    Perm111(.46593843871411818488381073359154639,
	    .35964594879750460000000000000001000),
    Perm111(.90639484399204150136249966186534000,
	    .07719437129575543228251522505271386)
};
QUAD QUAD_2D_P16_ = {
    "2D P16",			/* name */
    2,				/* dim */
    16,				/* order */
    Length(QUAD_2D_P16_wts),	/* npoints = 55 */
    QUAD_2D_P16_pts,		/* points */
    QUAD_2D_P16_wts,		/* weights */
    -1				/* id */
};

/* A 60-point order 17 rule found by using the number of points reported in:
 *	H. Xiao and Z. Gimbutas,
 *	A numerical algorithm for the construction of efficient quadrature
 *	rules in two and higher dimensions,
 *	Computers and Mathematics with Applications, 59 (2010), 663-676 */
static double QUAD_2D_P17_wts[] = {
    Dup21(.03829254008003568749425168889491817),
    Dup21(.01669528699775339594318472807122019),
    Dup21(.00143512454359061224492929722268097),
    Dup21(.02864276849185053630399044294140648),
    Dup21(.03408569078206214964786810427776196),
    Dup21(.02467274200053089056925349793140004),
    Dup21(.00586679757537134154263246190805349),
    Dup21(.02321859500422896151112767944153052),
    Dup111(.03084965458251406099116307348593810),
    Dup111(.01881398544005420038782109445200127),
    Dup111(.00512343450397285555007197439694996),
    Dup111(.00701239348475201777118052342883162),
    Dup111(.01538229443504461311363086994295179),
    Dup111(.00303013148261713122418018061550803)
};
static double QUAD_2D_P17_pts[Length(QUAD_2D_P17_wts) * 3] = {
    Perm21(.24056306963626902977934166278860247),
    Perm21(.08092323589766073062004798772340524),
    Perm21(.01001414912499135088254841140047604),
    Perm21(.15437652078663289107430782196727737),
    Perm21(.41716986201996268598941663596983268),
    Perm21(.47086974573840098186867398532866671),
    Perm21(.49811803384542204444865152799034832),
    Perm21(.36473840565291924199871629076775930),
    Perm111(.10986590708262616153720966373050601,
	    .30466576969866569523225839525499357),
    Perm111(.20493227462918790108024139159058423,
	    .05248758390645425414786013344982922),
    Perm111(.05813921564266244000000000000000000,
	    .01500053995225954378593128753997425),
    Perm111(.13859554086776482539309659376771751,
	    .01501023347973182500884052064335399),
    Perm111(.34660546952009260087829868774027952,
	    .02336212893314653752768977049783837),
    Perm111(.24821986889585591697209834974065293,
	    .00000099999999999965762180770907324)
	    /*9.99999999999657621807709073237881438e-7*/
};
QUAD QUAD_2D_P17_ = {
    "2D P17",			/* name */
    2,				/* dim */
    17,				/* order */
    Length(QUAD_2D_P17_wts),	/* npoints = 60 */
    QUAD_2D_P17_pts,		/* points */
    QUAD_2D_P17_wts,		/* weights */
    -1				/* id */
};

/* A 67-point order 18 rule found by using the number of points reported in:
 *	H. Xiao and Z. Gimbutas,
 *	A numerical algorithm for the construction of efficient quadrature
 *	rules in two and higher dimensions,
 *	Computers and Mathematics with Applications, 59 (2010), 663-676 */
static double QUAD_2D_P18_wts[] = {
    Dup3(.03074852123911585539935333820159969),
    Dup21(.02031833884545839730521676856098738),
    Dup21(.01379028660476693880147269080330003),
    Dup21(.00053200561694778056109294261721746),
    Dup21(.03347199405984789811876973462144190),
    Dup21(.03111639660200613119689389250158563),
    Dup21(.01310702749173875567860153100348528),
    Dup111(.01691165391748007879456553323826843),
    Dup111(.02759288648857947802009593334620683),
    Dup111(.01636590841398656595815221611374510),
    Dup111(.00764170497271963595084711372125680),
    Dup111(.00772983528000622700809279634102600),
    Dup111(.00958612447436150376044024017260990),
    Dup111(.00421751677474444290984387716007124),
    Dup111(.01532825819455314086704628681920691)
};
static double QUAD_2D_P18_pts[Length(QUAD_2D_P18_wts) * 3] = {
    Perm3(1./3.),
    Perm21(.15163850697260486492387353795772074),
    Perm21(.07243870556733287047426206374480081),
    Perm21(.00375894434106834585702462733286887),
    Perm21(.41106710187591949855469549486746318),
    Perm21(.26561460990537421478430796115175039),
    Perm21(.47491821132404573588789755091754023),
    Perm111(.06612245802840338770053947185398348,
	    .17847912556588763355267204638676643),
    Perm111(.26857330639601384733212028806856623,
	    .14906691012577383920019113944789784),
    Perm111(.30206195771287080772484323648551723,
	    .05401173533902423468044436247084948),
    Perm111(.13277883027138932992144407050471004,
	    .01433152477894195356844867129563809),
    Perm111(.25650615977424154068897765977748937,
	    .01050501881924193559868603344210775),
    Perm111(.41106566867461836291309677848250996,
	    .01169182467466708527042342649785763),
    Perm111(.04727614183265178252228403898505622,
	    .01249893248349544012804819357953175),
    Perm111(.38504403441316367334400254247436861,
	    .52452892523249571422861434426430408)
};
QUAD QUAD_2D_P18_ = {
    "2D P18",			/* name */
    2,				/* dim */
    18,				/* order */
    Length(QUAD_2D_P18_wts),	/* npoints = 67 */
    QUAD_2D_P18_pts,		/* points */
    QUAD_2D_P18_wts,		/* weights */
    -1				/* id */
};

/* Note: the rule QUAD_2D_P19 was taken from the book by
 *	P. Solin, K. Segeth, and I. Dolezel,
 *	"Higer-order Finite Element Methods",
 *	Chapman and Hall/CRC Press, 2003. */
static double QUAD_2D_P19_wts[] = {
    Dup3(.03290633138891865208361434484647497),
    Dup21(.01033073189127205336703996357174833),
    Dup21(.02238724726301639252918455603516271),
    Dup21(.03026612586946807086528019098259122),
    Dup21(.03049096780219778100003158657852042),
    Dup21(.02415921274164090491184803098664001),
    Dup21(.01605080358680087529162277027642948),
    Dup21(.00808458026178406048180567324219442),
    Dup21(.00207936202748478075134750167439841),
    Dup111(.00388487690498138975670499199277266),
    Dup111(.02557416061202190389292970195260027),
    Dup111(.00888090357333805774552592470351753),
    Dup111(.01612454676173139121978526932783766),
    Dup111(.00249194181749067544058464757594956),
    Dup111(.01824284011895057837766571320973615),
    Dup111(.01025856373619852130804807004235813),
    Dup111(.00379992885530191397907315371363970)
};
static double QUAD_2D_P19_pts[Length(QUAD_2D_P19_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.48960998707300633196613106574829817),
    Perm21(.45453689269789266204675939053572830),
    Perm21(.40141668064943118739399562381068860),
    Perm21(.25555165440309761132218176810926787),
    Perm21(.17707794215212955164267520651590115),
    Perm21(.11006105322795186130008495167737397),
    Perm21(.05552862425183967124867841247135571),
    Perm21(.01262186377722866849023476677870599),
    Perm111(.60063379479464500000000000000000000,
	    .39575478735694286230479469406582787),
    Perm111(.13446675453077978561204319893264695,
	    .55760326158878396836395324250118097),
    Perm111(.72098702581736505521665290233827892,
	    .26456694840652020804030173490121494),
    Perm111(.59452706895587092461388928802650670,
	    .35853935220595058842492699064590088),
    Perm111(.83933147368083857861749007714840520,
	    .15780740596859474473767360335950651),
    Perm111(.22386142409791569130336938950653642,
	    .70108797892617336732328833655951158),
    Perm111(.82293132406985663162747155916053316,
	    .14242160111338343731557475687723745),
    Perm111(.92434425262078402945585913790156314,
	    .06549462808293770339232652498592557)
};
QUAD QUAD_2D_P19_ = {
    "2D P19",			/* name */
    2,				/* dim */
    19,				/* order */
    Length(QUAD_2D_P19_wts),	/* npoints = 73 */
    QUAD_2D_P19_pts,		/* points */
    QUAD_2D_P19_wts,		/* weights */
    -1				/* id */
};

/* Rules 20-24, 26-29 are found by Simone Weikl (simone.weikl@googlemail.com),
 * Diploma Thesis, Technische Universiat Munchen, Zentrum Mathematik, 2011 */

static double QUAD_2D_P20_wts[] = {
    Dup3(.02343898837621685337578235989880370),
    Dup21(.01701187887065179140821050028462978),
    Dup21(.02213462902539847149771471956849632),
    Dup21(.02225012034148936704815054477635356),
    Dup21(.02108801427518765728972259255778044),
    Dup21(.01436673198237250674135242117943876),
    Dup21(.00596064247309054870158068681368087),
    Dup21(.00185446185638856226012710730597991),
    Dup111(.00766503799888173467975505965999393),
    Dup111(.00611096641377269564490800130795800),
    Dup111(.00329750122890750342409287108138500),
    Dup111(.00258504328745784243926241647780699),
    Dup111(.01604829966346833686116840419650012),
    Dup111(.00987379147789446687652271685071374),
    Dup111(.00817314741769008089505196969930370),
    Dup111(.02127212420812707803762062418100071),
    Dup111(.01629559968072678577307785994248523),
    Dup111(.01910541781474788066581373037653881)
};
static double QUAD_2D_P20_pts[Length(QUAD_2D_P20_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.47253969049374944291236394079678822),
    Perm21(.43559179765819053474788158522088855),
    Perm21(.38548317769095410374903697427852223),
    Perm21(.18589787266938260089793207404361894),
    Perm21(.10294309387227568202927226453268166),
    Perm21(.04420435682210499536228665005842580),
    Perm21(.01187700008194990884008379159291605),
    Perm111(.42317710194393600041367501539791831,
	    .56624681421216737896202019229528315),
    Perm111(.28717803493735130968896269265785627,
	    .70363134375008177073022062562769704),
    Perm111(.16282486571070316869304103317873899,
	    .83237331116054735414989063179341648),
    Perm111(.06468063449817511170284328732719589,
	    .92925769945837560706677619337951412),
    Perm111(.33400627700511908113700959506140627,
	    .61323701639938793580192466071340766),
    Perm111(.21092379552418127847921338445298798,
	    .75151051490601053625741794541954190),
    Perm111(.11508038084136831598057023754719804,
	    .85015113156210283588089253042485358),
    Perm111(.31075208646508429564535326048014931,
	    .56198974953953613108255692415961755),
    Perm111(.20200619801045898902767636571938539,
	    .70171644023616188456192811677305342),
    Perm111(.28902320790895929973608959414472710,
	    .49138856232319209839401293034098827)
};
QUAD QUAD_2D_P20_ = {
    "2D P20",			/* name */
    2,				/* dim */
    20,				/* order */
    Length(QUAD_2D_P20_wts),	/* npoints = 82 */
    QUAD_2D_P20_pts,		/* points */
    QUAD_2D_P20_wts,		/* weights */
    -1				/* id */
};

/* The rule below is reported in the paper:
 *	Papanicolopulos, S., A.,
 * 	New fully symmetric and rotationally symmetric cubature rules on the
 * 	triangle using minimal orthonormal bases,
 *	J. Computational and Applied Mathematics, Vol. 294, 2016, pp.39-48 */
static double QUAD_2D_P21_wts[] = {
    Dup21(.00153252214157029927832972284942362),
    Dup21(.00295964208580089055557643244435822),
    Dup21(.00710507195198322705473634640429004),
    Dup21(.01242202545015119261392701182790142),
    Dup21(.01315385309054860400530165567389379),
    Dup21(.01610711993355940881429849025111080),
    Dup21(.01955699832742153003791726026064669),
    Dup21(.02114714580341115240235728776162335),
    Dup21(.02148724961809553292499438055586582),
    Dup111(.00324321603629715843164230514808509),
    Dup111(.00444606682456729614112175291076191),
    Dup111(.00444713701276898568121864572732943),
    Dup111(.00719283008979440275755795626382300),
    Dup111(.00968818276967735751464842894718971),
    Dup111(.01077186725474600415287816641481312),
    Dup111(.01537644879227419490362875554570800),
    Dup111(.01541820162505099647808429434299382),
    Dup111(.01872799408182348912155361034660658),
    Dup111(.01961890797839586264061345700479913)
};
static double QUAD_2D_P21_pts[Length(QUAD_2D_P21_wts) * 3] = {
    Perm21(.01083064791389613439818531875282892),
    Perm21(.49868116928006762187511807510022292),
    Perm21(.05320630259370221372937428477043579),
    Perm21(.48436880679907196058128682726473251),
    Perm21(.11717932446409532061312493414817476),
    Perm21(.18619987453160044065356184245386411),
    Perm21(.23770504697050237030777008826766300),
    Perm21(.45111809686333143558277239278860940),
    Perm21(.29890161661837960265935712860196744),
    Perm111(.01017037551397023833029242013076474,.05610607874044113073901605353578031),
    Perm111(.00740148001912942691985111704851672,.23806090893927819107377783880076336),
    Perm111(.00948888021003903598802889438007338,.13371423612729252503412567154133090),
    Perm111(.01078708528953292731070298166591233,.36087827036133643028378433162192850),
    Perm111(.04888641015641196213015335363186247,.12856000707434670174510612755634180),
    Perm111(.04079047843492138579001393428298806,.23192922019831618515287729451119134),
    Perm111(.10225476525427212998164710587805099,.21318238024685212224076314392042087),
    Perm111(.05619510372649343472752614615138017,.34615363893081412151163375832691108),
    Perm111(.19392111402204940534236787859220491,.35741779412597604193763009688130316),
    Perm111(.13139693759954925634229231531863966,.30964180048539107980510336108955521)
};
QUAD QUAD_2D_P21_ = {
    "2D P21",			/* name */
    2,				/* dim */
    21,				/* order */
    Length(QUAD_2D_P21_wts),	/* npoints = 87 */
    QUAD_2D_P21_pts,		/* points */
    QUAD_2D_P21_wts,		/* weights */
    -1				/* id */
};

/* The rule below is reported in the paper:
 *	Papanicolopulos, S., A.,
 * 	New fully symmetric and rotationally symmetric cubature rules on the
 * 	triangle using minimal orthonormal bases,
 *	J. Computational and Applied Mathematics, Vol. 294, 2016, pp.39-48 */
static double QUAD_2D_P22_wts[] = {
    Dup21(.00069714569625074030369942481362133),
    Dup21(.00173365376198036236244040089465219),
    Dup21(.00466131304304557368006266059260170),
    Dup21(.01158457676559956471190194225470023),
    Dup21(.01187897403302190998142733919159934),
    Dup21(.01533880365566670016085333491517060),
    Dup21(.01971637694027233703178135471037246),
    Dup21(.02057215149173475351932757540044250),
    Dup21(.02384066027813703919931347525917147),
    Dup21(.02446119708987487225534932817494781),
    Dup111(.00182862802731120927204804019418561),
    Dup111(.00188044970396283839898767788993490),
    Dup111(.00370410864001110188501003141229496),
    Dup111(.00466834037183480579057625840302880),
    Dup111(.00721134117192958564362665357306283),
    Dup111(.00796743335988734266364119940269571),
    Dup111(.00903580036943713630598503580960509),
    Dup111(.00948064111155901466263790694355664),
    Dup111(.01561737012835320857159572546229795),
    Dup111(.01624531918105698418898193939757981),
    Dup111(.02178480822353151268049778007478454)
};
static double QUAD_2D_P22_pts[Length(QUAD_2D_P22_wts) * 3] = {
    Perm21(.00722823551590805269240186985118743),
    Perm21(.49971491656223188463531154910591767),
    Perm21(.04195252727280408802705553682804348),
    Perm21(.31413219152050094565940577630042994),
    Perm21(.48001365161711654879356466888729030),
    Perm21(.12308745423016114898448687333895172),
    Perm21(.44571963043911530549256371899531770),
    Perm21(.18986241218389367642303052024426076),
    Perm21(.26033923338175577283598939801891875),
    Perm21(.39636684767162598240715439210378845),
    Perm111(.00773958468860307799587341381217818,.03910016782732837999359532547054414),
    Perm111(.00057706413021840388680988197995853,.29956301031600608000000000000000000),
    Perm111(.00979577185352314036856347829609728,.09916758085225246952608204467401148),
    Perm111(.00918868020649896490029828421437019,.18619068155280570806618576756346898),
    Perm111(.01346708756840181797029316077776570,.40293889185510044331704310704540997),
    Perm111(.05062631246733689522786952921020785,.10358808540929187702277517444504398),
    Perm111(.04838811776183765022487372116607709,.18082300688832890010580439799931826),
    Perm111(.02749143585326034673258117826660649,.28194341507949187524318191991162303),
    Perm111(.06713397444770439007586079560898384,.35071285339799134366628146898304461),
    Perm111(.09670430361686034561495436311127678,.23017640440360132139166340852745074),
    Perm111(.15193045482670229286438888320778608,.31159323586348644974639923203001594)
};
QUAD QUAD_2D_P22_ = {
    "2D P22",			/* name */
    2,				/* dim */
    22,				/* order */
    Length(QUAD_2D_P22_wts),	/* npoints = 96 */
    QUAD_2D_P22_pts,		/* points */
    QUAD_2D_P22_wts,		/* weights */
    -1				/* id */
};

/* The rule below is reported in the paper:
 *	Papanicolopulos, S., A.,
 * 	New fully symmetric and rotationally symmetric cubature rules on the
 * 	triangle using minimal orthonormal bases,
 *	J. Computational and Applied Mathematics, Vol. 294, 2016, pp.39-48 */
static double QUAD_2D_P23_wts[] = {
    Dup21(.00102338493393064825880875292048368),
    Dup21(.00234953285611607429820752203919566),
    Dup21(.00442272294831746458300712854673892),
    Dup21(.00935939493458907159588059346569364),
    Dup21(.01122330490795551618339838001860665),
    Dup21(.01145539386071866483451404196187953),
    Dup21(.01485152819027043031788493609445202),
    Dup21(.01873399097752303244589658710992199),
    Dup21(.02009544889817501015648393973138171),
    Dup21(.02186952160246302231865049077371942),
    Dup111(.00139037413890586280792572004623041),
    Dup111(.00209361317170022977809045175923150),
    Dup111(.00226272789116058493926098904342501),
    Dup111(.00509887607853182356576648513174798),
    Dup111(.00580279248634163562097040517303610),
    Dup111(.00699047412016323154662825915726588),
    Dup111(.01010544741268549508636466193618720),
    Dup111(.01094068682011104235992829469791130),
    Dup111(.01269774746720014444245594705387966),
    Dup111(.01493690521473593308948584780344384),
    Dup111(.01624594488896314707519973030797813),
    Dup111(.02040896492113806885822368822529305)
};
static double QUAD_2D_P23_pts[Length(QUAD_2D_P23_wts) * 3] = {
    Perm21(.00884309098564000781144468419871075),
    Perm21(.49904231799536473576318688106778703),
    Perm21(.04191849463192120115455956274854522),
    Perm21(.08384395940074188671519383182016759),
    Perm21(.35156602225687808437472423305189879),
    Perm21(.48142250008209757218970635991224348),
    Perm21(.13603683917665686011746620285416514),
    Perm21(.44588621023292908434421744174344724),
    Perm21(.19833791969077397732302473244075886),
    Perm21(.39764873352592070572902821621712745),
    Perm111(.00215375088982479143593969096276917,.11147822164436514858831541609060182),
    Perm111(.00797567048343379974299672675667051,.04599876191192738898335879375393121),
    Perm111(.00222521306870228962165445623994274,.29991704500621364115075519706889153),
    Perm111(.01056799023421332981938693231799616,.19450617255148173513923298602622080),
    Perm111(.02639015796005238716769753666365164,.10487601375183195540194359053325350),
    Perm111(.01372661478891633442412470482374058,.39359274155812221677807114606384301),
    Perm111(.03293167071711912354883994110324428,.27745010154284908600010796990105572),
    Perm111(.05645836928678800749584878194121292,.17041930960722382214358721748321713),
    Perm111(.24905869950604636107649169253437782,.28048464594062623291197233102900262),
    Perm111(.06710022884559872615982757386133093,.35940684385217631018244572992741760),
    Perm111(.10095848404745636455551318905522403,.23967897332407877845308433492438781),
    Perm111(.15208140311691476836002821658866124,.31660538238914823066544783358734965)
};
QUAD QUAD_2D_P23_ = {
    "2D P23",			/* name */
    2,				/* dim */
    23,				/* order */
    Length(QUAD_2D_P23_wts),	/* npoints = 102 */
    QUAD_2D_P23_pts,		/* points */
    QUAD_2D_P23_wts,		/* weights */
    -1				/* id */
};

/* The rule below is reported in the paper:
 *	Papanicolopulos, S., A.,
 * 	New fully symmetric and rotationally symmetric cubature rules on the
 * 	triangle using minimal orthonormal bases,
 *	J. Computational and Applied Mathematics, Vol. 294, 2016, pp.39-48 */
static double QUAD_2D_P24_wts[] = {
    Dup3(.02293794348096749067720820639821200),
    Dup21(.00076737746111581423045153600120047),
    Dup21(.00552357844475169754997038457424443),
    Dup21(.00838499530275631071273403550487762),
    Dup21(.01221738017800235239788392469826439),
    Dup21(.01307039060561178310890784719893180),
    Dup21(.01788122775842957825015047766363903),
    Dup21(.01822174413909730956979133198261050),
    Dup21(.02164149721756761699449458590855473),
    Dup21(.02168831292692260197279166115848309),
    Dup111(.00174618458266172170313203275603945),
    Dup111(.00183857160374278724340785925075360),
    Dup111(.00199893663336212883772988094673110),
    Dup111(.00206369617133590779327617815189614),
    Dup111(.00229539508715841568165484400462521),
    Dup111(.00457952328890823144675590528548258),
    Dup111(.00529323009909540365054590996973504),
    Dup111(.00557874699599088171390666100209646),
    Dup111(.00861933948725664134146173130325259),
    Dup111(.00999235399224706921212863098136616),
    Dup111(.01030561620768130769226672677282150),
    Dup111(.01460454612625024725227714201539116),
    Dup111(.01499850067625046347206078267251109),
    Dup111(.01923078311743667878627312147552622)
};
static double QUAD_2D_P24_pts[Length(QUAD_2D_P24_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.00764481587209140357148961957868539),
    Perm21(.49512326693489419346010327445636948),
    Perm21(.08533571470774055253577908615445653),
    Perm21(.47540435757943002732921306991884855),
    Perm21(.14361312600254966163076940146917127),
    Perm21(.44000137550057370651541171540277806),
    Perm21(.20438684787130391661942173912629914),
    Perm21(.39155520703268199132653695865910252),
    Perm21(.26936069184956821890376700734821267),
    Perm111(.00128915765322182138873877223282987,.38930032117370399940994358985608046),
    Perm111(.00804615544134750962080148406751868,.03994551899851089671071946872000290),
    Perm111(.00397463904079080448292596145774045,.17756755351844720149250759536631588),
    Perm111(.00565339683877998034115515308702144,.09730437316339079594262256407299041),
    Perm111(.03654164634700071865936106746572505,.04737913646955582393784813835746318),
    Perm111(.00847203125278924422001665909111615,.27654233490622630027478984616955668),
    Perm111(.03186878555848486368527331611156268,.10186004800841345175103882567179717),
    Perm111(.02507448575695932327989859470575696,.17990041142989784948776341885611339),
    Perm111(.02495464920723698331110869690511693,.37476148829145151703198672023817762),
    Perm111(.07180692748992666960708660113790562,.16285371365641890528167019069210662),
    Perm111(.04649536832522560731056542252010275,.26299994692532693286696577835230479),
    Perm111(.07944565832892777248067300362002874,.35387462268603241581179193663132046),
    Perm111(.11210496839891452618514886571897182,.24045272001109686579097131221331152),
    Perm111(.16288704432089312482891199962593472,.31632883636136616749409848630342490)
};
QUAD QUAD_2D_P24_ = {
    "2D P24",			/* name */
    2,				/* dim */
    24,				/* order */
    Length(QUAD_2D_P24_wts),	/* npoints = 112 */
    QUAD_2D_P24_pts,		/* points */
    QUAD_2D_P24_wts,		/* weights */
    -1				/* id */
};

/* The rule below is reported in the paper:
 *	S. Wandzura and H. Xiao, Symmetric quadrature rules on a triangle,
 *	Computers and Mathematics with Applications, 45 (2003), 1829�C1840,
 * and was communicated by Don Wilton (dwilton@mindspring.com) */
static double QUAD_2D_P25_wts[] = {
    Dup21(.00800558188002042313368589293942171),
    Dup21(.01594707683239049085408554937789681),
    Dup21(.01310914123079550369839487163291327),
    Dup21(.01958300096563560520647726105123795),
    Dup21(.01647088544153726359394636789647424),
    Dup21(.00854727907409214131204679403754348),
    Dup21(.00816188585722650120293135168156145),
    Dup21(.00612114653998375062550303141747500),
    Dup21(.00290849826493666035989604760244737),
    Dup21(.00069227524566199872959231564688970),
    Dup111(.00124828919927740405463308732687347),
    Dup111(.00340475290880302630290932517884509),
    Dup111(.00335965432606405469389982622818046),
    Dup111(.00171615653949675776835927257382091),
    Dup111(.00148085631671560275966191325505238),
    Dup111(.00351131261072868028754024041382735),
    Dup111(.00739355014970648910670774728325426),
    Dup111(.00798308747737656611293770143977919),
    Dup111(.00435596261315803802370299459187773),
    Dup111(.00736505670141783108374850348433179),
    Dup111(.01096357284641954589593589943582605),
    Dup111(.01174996174354112327739198111865119),
    Dup111(.01001560071379857640896706453029824),
    Dup111(.01330964078762866755490152722632760),
    Dup111(.01415444650522613072733705129605375),
    Dup111(.01488137956116800324975278964173671)
};
static double QUAD_2D_P25_pts[Length(QUAD_2D_P25_wts) * 3] = {
    Perm21(.48602675846341286632108494106576852),
    Perm21(.43441069933617422686934557925604870),
    Perm21(.38988913524396382753969636952404462),
    Perm21(.29844323401980449068329287355490048),
    Perm21(.23404417233737183658023656970596734),
    Perm21(.15146833460901760000000000000000000),
    Perm21(.11273389354599349281729186486594851),
    Perm21(.07771569209152620223369817320827966),
    Perm21(.03489309361429690849533026177733858),
    Perm21(.00725818462093238916117013110606335),
    Perm111(.00129235270444219584099302931665302,.22721445215336410000000000000000000),
    Perm111(.00539970127211620182189732363132860,.43501055485357173125113362379450230),
    Perm111(.00638400303397498941895749776744540,.32030959927220447113000026445341979),
    Perm111(.00502821150199308271328582097413442,.09175032228000531039287201063543536),
    Perm111(.00682675862178184570668051931419220,.03801083585872443391784793002157854),
    Perm111(.01001619963992951145867446496978043,.15742521848531178511320753380098114),
    Perm111(.02575781317339004661287123576293491,.23988965977853325914298591466950265),
    Perm111(.03022789811991582345896227492462806,.36194311812606053179871201193912355),
    Perm111(.03050499010716207795935512861230592,.08355196095482845510691464351287596),
    Perm111(.04595654736256931928622033280840303,.14844322073241812268238560824628123),
    Perm111(.06744280054027761427028802732221226,.28373970872753497227148332506495505),
    Perm111(.07004509141591061747706842947324321,.40689937511878760390382808292080011),
    Perm111(.08391152464011664050042868280051014,.19411398702489250643935208871855679),
    Perm111(.12037553567715270000000000000000000,.32413434700070320631848835964861372),
    Perm111(.14806689915736669746097550576436943,.22927748355598104616627200389359665),
    Perm111(.19177186586732510675561189736742768,.32561812259598383120936369037062376)
};
QUAD QUAD_2D_P25_ = {
    "2D P25",			/* name */
    2,				/* dim */
    25,				/* order */
    Length(QUAD_2D_P25_wts),	/* npoints = 126 */
    QUAD_2D_P25_pts,		/* points */
    QUAD_2D_P25_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P26_wts[] = {
    Dup3(.01417752160999602353323977972271527),
    Dup21(.01562847738814814970970457453697594),
    Dup21(.01463752622911178264133988219347403),
    Dup21(.01199877346634344861456211855900933),
    Dup21(.01408927503571013898691920328509770),
    Dup21(.01137089506541742371508421522672789),
    Dup21(.00576148405319945074736514087034656),
    Dup21(.00288047484993807908673712870762860),
    Dup21(.00061792400780682863983571128624684),
    Dup111(.00369419331787613967876812943308712),
    Dup111(.00343799094677204927555439258769779),
    Dup111(.00286153444220796869854630479719978),
    Dup111(.00203926220043675486828725055944921),
    Dup111(.00212260415935469294564133350026422),
    Dup111(.00119562615477588655866810063068187),
    Dup111(.00685739162489405400311650380844794),
    Dup111(.00734359958211473751194803942744208),
    Dup111(.00692380910755335710497733455285917),
    Dup111(.00568034562903817703600660475801349),
    Dup111(.00482902212700270888221406835346564),
    Dup111(.01217016111615610869604849372625312),
    Dup111(.01093398470027832184481918666951027),
    Dup111(.00874472678661106729318818910817295),
    Dup111(.00680604517250698803302377412054323),
    Dup111(.01411590919743288381954091229224022),
    Dup111(.01311478562571945830368980380706058),
    Dup111(.01294033945976499045298096058107199)
};
static double QUAD_2D_P26_pts[Length(QUAD_2D_P26_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.42738077638464831074877265985432388),
    Perm21(.38699172838462112393769349339592202),
    Perm21(.29080160649677600000000000000000000),
    Perm21(.21955119391561192225377283920396941),
    Perm21(.14147766876769242783780816190264115),
    Perm21(.08529773902470504192646771859292695),
    Perm21(.03245379871194203562256093430387330),
    Perm21(.00688528565235726390272245979876787),
    Perm111(.43994521155768505420225073420375411,
	    .55367421644525807832051112152536738),
    Perm111(.32999703483323129491627843183841851,
	    .66364319673874589711499831297210598),
    Perm111(.23082959156933124460906369415091164,
	    .76308863521363336439140145775470392),
    Perm111(.14794411408540751228070615912033131,
	    .84674293184236109088401920967886276),
    Perm111(.08331051165939022562807285094666142,
	    .90927752172075602921190126258082178),
    Perm111(.03550260326758216848726613913161973,
	    .95859557015929357672073151433554495),
    Perm111(.43799285096397419659511807977149749,
	    .52875010002019513801184885338236967),
    Perm111(.34184511530123979780425420810756385,
	    .62501066255799393838930209588631898),
    Perm111(.24321991316551786475075820451965981,
	    .72464470136332536323906998980156002),
    Perm111(.15369391178063810461104521948139224,
	    .81668780811826632451173297381674549),
    Perm111(.08182824840515584556272055876947980,
	    .88137737650647236457017244683395591),
    Perm111(.40543528702386735945093314372836966,
	    .51444288504473371249851667233726474),
    Perm111(.30047523445100120928119574237532588,
	    .62059693664252388102960854157646856),
    Perm111(.21029877498305665945876052946338960,
	    .71260468401313836547438957626142950),
    Perm111(.14192949723680286586293618687501310,
	    .78364422636910025200372459985859611),
    Perm111(.32282570605532179374541311121620042,
	    .53538969633347138690064718160659645),
    Perm111(.22503850086766503651915588373212567,
	    .63399334111941569685209117569438308),
    Perm111(.30622801452292528203795810454570981,
	    .48023900880456248705776905427268046)
};
QUAD QUAD_2D_P26_ = {
    "2D P26",			/* name */
    2,				/* dim */
    26,				/* order */
    Length(QUAD_2D_P26_wts),	/* npoints = 133 */
    QUAD_2D_P26_pts,		/* points */
    QUAD_2D_P26_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P27_wts[] = {
    Dup3(.00132645422676788269875694817310637),
    Dup21(.01017606777254880480746165608356455),
    Dup21(.01355363518955792585297110164615270),
    Dup21(.01435575232352898855810447417832482),
    Dup21(.01762154025479284493331530463863313),
    Dup21(.01286456612407540576521896438320606),
    Dup21(.01021120788721442034062871052526150),
    Dup21(.00805484559136441340259536953879069),
    Dup21(.00485083247712445072994650912354335),
    Dup21(.00276034923845063648517112406186915),
    Dup21(.00064652022402423359706690809995414),
    Dup111(.00298280618704304171833833804758432),
    Dup111(.00286890029157565788749757647924691),
    Dup111(.00146771786779737406777795858954528),
    Dup111(.00163545643437809674920446933139427),
    Dup111(.00326270663499477733596716702887470),
    Dup111(.00127830372794885836417837000658451),
    Dup111(.00355054931897130700729806858502069),
    Dup111(.00705687847901615495175919551339405),
    Dup111(.00710874754932738751234293916033450),
    Dup111(.00619331568447356835579144233234119),
    Dup111(.00430573263634848540647054196708181),
    Dup111(.00538152713709093753671677026319717),
    Dup111(.00946147607081304454837567274132095),
    Dup111(.01038776441184486432462624183330042),
    Dup111(.00693741437082199035643509373698783),
    Dup111(.01056786087493971379972576670902532),
    Dup111(.01001591520410395750929434758482549),
    Dup111(.01145776939470566123752859291178484),
    Dup111(.01297709014466941197797189467632131)
};
static double QUAD_2D_P27_pts[Length(QUAD_2D_P27_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.46427084805466920349262004314703836),
    Perm21(.43229831434028157352333551631753476),
    Perm21(.39075381477193176882883899825279826),
    Perm21(.29984903083812250736371384535095833),
    Perm21(.24238609336669501198579355664452309),
    Perm21(.19575163384470794764935880541589295),
    Perm21(.11096422071801854111207889228991412),
    Perm21(.06784943782072336611132231104850517),
    Perm21(.03248814431443691367844218208374596),
    Perm21(.00702227048619495308291407220447055),
    Perm111(.44433448769671943201275224300444114,
	    .55016916248187282000891941332861776),
    Perm111(.24271988774832453561075341685216292,
	    .75119868054856110177318171512240453),
    Perm111(.15818892475209601952406305738166283,
	    .83835069531284232651520750772598161),
    Perm111(.08845560649090179633078521783025438,
	    .90629410967510652581883999276555543),
    Perm111(.33999316891507000002332849881468819,
	    .65372187099256441503697325319687970),
    Perm111(.03671154847229659731571109853308589,
	    .95724604370116430180960160528414269),
    Perm111(.08124029610361356005058157071908989,
	    .89177919384281966240532352562349587),
    Perm111(.43194999140455781310320628223711064,
	    .53892333102966923458236030560490706),
    Perm111(.32699693161719831316306130873483095,
	    .64047090201394740296518952785936033),
    Perm111(.23408117072735995645396481889795017,
	    .73431597148508412293269931866205238),
    Perm111(.15347363272308466475181254734395719,
	    .82492267618399551423539156004582949),
    Perm111(.12699941589030054190683503157639795,
	    .81688483424950280690392059398500667),
    Perm111(.36806660226545525465188762517330287,
	    .55934053585742889058858737838306859),
    Perm111(.26979607114851247262701085083588115,
	    .65088590636580683812387505565452156),
    Perm111(.18699471085773505905185124894492060,
	    .74499601198138427785033316282140954),
    Perm111(.34595044287272788784072078462621499,
	    .52709408040032769073500598867000113),
    Perm111(.18245632238005479720023182986667859,
	    .69385768740918414496471841615003464),
    Perm111(.26018384965949842909231289915918049,
	    .59478379886135638965559275913807350),
    Perm111(.31984867358313578155757977176391537,
	    .48237346031069377766871464449285085)
};
QUAD QUAD_2D_P27_ = {
    "2D P27",			/* name */
    2,				/* dim */
    27,				/* order */
    Length(QUAD_2D_P27_wts),	/* npoints = 145 */
    QUAD_2D_P27_pts,		/* points */
    QUAD_2D_P27_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P28_wts[] = {
    Dup3(.00372851181690746808458802773780931),
    Dup21(.00193654415522499089798121523079372),
    Dup21(.00605141039266348349682076643537264),
    Dup21(.01141411355071663950946117311831634),
    Dup21(.01608007376313012939112012516866485),
    Dup21(.01403532910432407033763380729780537),
    Dup21(.00978327794286426243399757092983715),
    Dup21(.01267830169820560106561705330317056),
    Dup21(.01011411585946974486266089228810336),
    Dup21(.00376318422499545225814714605310903),
    Dup21(.00243119330615522129960297283149783),
    Dup21(.00042588994531646428122960119842518),
    Dup111(.00206901772064515543837924811367839),
    Dup111(.00215432386268054430571141067616092),
    Dup111(.00166065394763716989540584667501249),
    Dup111(.00138084032913645059993106848688128),
    Dup111(.00360171025661803306118091200062737),
    Dup111(.00097386114094506619777294737048538),
    Dup111(.00535413394306626012053016995775099),
    Dup111(.00423736286661477466768017827663045),
    Dup111(.00330847570421703082215419515418717),
    Dup111(.00448583942101861046216741271009491),
    Dup111(.00776555845120818901711264608747662),
    Dup111(.00687043734971177067707693439653168),
    Dup111(.00584068837096601687691778384738186),
    Dup111(.00888657317183860444062439413402823),
    Dup111(.01038315778562466496474547463182699),
    Dup111(.00655128753862388719526464995777170),
    Dup111(.00877076875255828946048204111223478),
    Dup111(.01218892935729072907621500755722349),
    Dup111(.01250643549629844281533668106200953),
    Dup111(.01269847559228270197407683124148953)
};
static double QUAD_2D_P28_pts[Length(QUAD_2D_P28_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.49835341312677973221949148740253129),
    Perm21(.48856275409050881854170094866703248),
    Perm21(.46478147828724737521816425323927792),
    Perm21(.38976627332101772838564635544311420),
    Perm21(.30154675118298200000000000000000000),
    Perm21(.26157407405925900000000000000000000),
    Perm21(.21410788634590951182959860455114779),
    Perm21(.17013819127147552416852263597020987),
    Perm21(.06437078350269442260455184210867187),
    Perm21(.03056003210401320908223320131174623),
    Perm21(.00570940793308473608535324150722078),
    Perm111(.29536153497141490674708319047417597,
	    .70085350685240175269511103394845061),
    Perm111(.20287670215559760434708665743838398,
	    .79193561974577570926640621745254478),
    Perm111(.12817949523631330608909975560928685,
	    .86701504698388816611813701911598314),
    Perm111(.07052544109205498392587648111966164,
	    .92391986491477366531821910182946052),
    Perm111(.39532631740896702860171237522193030,
	    .59771306110677331467243551041521591),
    Perm111(.02956827316914143637172672359648260,
	    .96465253113231383432304266408275803),
    Perm111(.30675094998690715371535728527788425,
	    .66850082953013352645351336823624571),
    Perm111(.22517182313337122500507617369889188,
	    .75132263382025994493510577224942991),
    Perm111(.07635892427059552575901260109062831,
	    .89611941137326587665824353804536658),
    Perm111(.14042475531972069418905256134644577,
	    .83328227859710106355842490700741297),
    Perm111(.39118747052871590865900820029002383,
	    .57082898894634335709509739044406166),
    Perm111(.19396081112987221646366179522225910,
	    .75010271498110326795986200675381153),
    Perm111(.11586020721321567595528110784524463,
	    .81777490624407893257309046195761535),
    Perm111(.28023728574593295635247200998364845,
	    .65528264369963779978719065630966078),
    Perm111(.35489334757487301545619510855666152,
	    .55787563056563336146991239029436233),
    Perm111(.14534210735467833470209926430836432,
	    .74965464658825236845917501382975580),
    Perm111(.21353594460615902118568163630567554,
	    .67815620035398476715714603087527412),
    Perm111(.38905986757978011881345023070696881,
	    .47478610218807292068119420965885141),
    Perm111(.27562890222960030201915925622737738,
	    .58603008200093619992681987776326855),
    Perm111(.31377995329904710006329372044106871,
	    .49151146351194286330016259453399046)
};
QUAD QUAD_2D_P28_ = {
    "2D P28",			/* name */
    2,				/* dim */
    28,				/* order */
    Length(QUAD_2D_P28_wts),	/* npoints = 154 */
    QUAD_2D_P28_pts,		/* points */
    QUAD_2D_P28_wts,		/* weights */
    -1				/* id */
};

static double QUAD_2D_P29_wts[] = {
    Dup3(.01390369197243498012196860526728523),
    Dup21(.00119407074555933681859037971323571),
    Dup21(.00558417807814421700320296020710969),
    Dup21(.01401429650050351710041595861194328),
    Dup21(.01410780604708034305616878409304137),
    Dup21(.01342810431576591351787528351663394),
    Dup21(.01217537497609338458269338763086290),
    Dup21(.00722294427143959319468499698239233),
    Dup21(.00443751867960735637759182913807913),
    Dup21(.00019771881519265609682851845605640),
    Dup111(.00129189419129147303154103509431602),
    Dup111(.00112772642035394166015974617443553),
    Dup111(.00184745171735374848441682404155343),
    Dup111(.00071782203324654941618021167082972),
    Dup111(.00351318664214703198725396103172539),
    Dup111(.00349660600844854338988705837555120),
    Dup111(.00241690948038281274650124841577492),
    Dup111(.00081313466613996608724908914031470),
    Dup111(.00564942974660398293146765321429865),
    Dup111(.00445904031659885067338404631595062),
    Dup111(.00185640152529500022792451101805069),
    Dup111(.00701742231395962656370871380070187),
    Dup111(.00476963067992196310852157152860163),
    Dup111(.00768181583252764607257537723234668),
    Dup111(.00866304121915658321589732638654127),
    Dup111(.00694192073189620264349957702824600),
    Dup111(.00608713825993680733195825320444232),
    Dup111(.00987867211691082287437749173658670),
    Dup111(.01040317740016649468355653503351506),
    Dup111(.00677295750139824628718993144871263),
    Dup111(.00832356466794721739792214655562608),
    Dup111(.01175825678556958331667970045402759),
    Dup111(.01268117819931458364046050771195975)
};
static double QUAD_2D_P29_pts[Length(QUAD_2D_P29_wts) * 3] = {
    Perm3(.33333333333333333333333333333333333),
    Perm21(.49941626286799955409520464498316269),
    Perm21(.48948346983261497522938052895559610),
    Perm21(.38337490646926000907612840544797942),
    Perm21(.28657967124624950515035657391568590),
    Perm21(.23675743798075908296846185092132762),
    Perm21(.18444854262549379977888738237869426),
    Perm21(.09592097238345002706204055857161251),
    Perm21(.05732663714886085602392016667935097),
    Perm21(.00360814709934401389942946854275571),
    Perm111(.32459168027628713302158859225874986,
	    .67371212175894638940968866052450810),
    Perm111(.20538296110395026907966241605897587,
	    .79285585098032246467154265489876875),
    Perm111(.12781715504878891712709027697510756,
	    .86682261130980615198333080160570653),
    Perm111(.06397213170443202744985506555180679,
	    .93422003016808671513846621034706181),
    Perm111(.40877270304610163463977433263460813,
	    .58330425747295030197062188244089100),
    Perm111(.26000366001505949148390106470940356,
	    .72820244365190777874589416567626502),
    Perm111(.08370103760471207151750106127384500,
	    .89846466640643977698190152996194171),
    Perm111(.02277724243943714846816275979306666,
	    .97158629182957065178007512301223061),
    Perm111(.33249703304933480878170490873619909,
	    .64248824389424048968615511405857584),
    Perm111(.17546771597780866991339541376496896,
	    .80343317590650447549486585236617441),
    Perm111(.04239144337139153742306881985042489,
	    .93728223742102642341436645741650662),
    Perm111(.23808696074926436006355587074260398,
	    .71698190885093363334019663932316818),
    Perm111(.11385025949319543285234976170424461,
	    .84431131334463485469301787175078758),
    Perm111(.40769947121073335745665277255775013,
	    .54824721541790114707748890982833737),
    Perm111(.30971996601029726066117003751273698,
	    .62232557895213827911084197477161010),
    Perm111(.16501257707342404851428639610530038,
	    .76776792910869773214284522469888712),
    Perm111(.43736489346938777507788866536148926,
	    .48468874869866900000000000000000000),
    Perm111(.23036169231961739485460160639223048,
	    .66627592302530221745209390079397421),
    Perm111(.35305476702238759018727511157688575,
	    .54053899274173894698475001785466288),
    Perm111(.15871875580457590021286449358564550,
	    .72119885820756830541154885697690356),
    Perm111(.40214959194205300000000000000000001,
	    .45482738530050760506736521027227478),
    Perm111(.27186848606196062046228695803969211,
	    .57716886061275534659861021805529577),
    Perm111(.32870389995531448574405098549674708,
	    .47881463249708848352487404443818064)
};
QUAD QUAD_2D_P29_ = {
    "2D P29",			/* name */
    2,				/* dim */
    29,				/* order */
    Length(QUAD_2D_P29_wts),	/* npoints = 166 */
    QUAD_2D_P29_pts,		/* points */
    QUAD_2D_P29_wts,		/* weights */
    -1				/* id */
};

/*---------------------------- 3D cubature rules ---------------------------*/

static double QUAD_3D_P1_wts[] = {
    Dup4(1.)
};
static double QUAD_3D_P1_pts[Length(QUAD_3D_P1_wts) * 4] = {
    Perm4(.25)
};
QUAD QUAD_3D_P1_ = {
    "3D P1",			/* name */
    3,				/* dim */
    1,				/* order */
    Length(QUAD_3D_P1_wts),	/* npoints = 1 */
    QUAD_3D_P1_pts,		/* points */
    QUAD_3D_P1_wts,		/* weights */
    -1				/* id */
};

static double QUAD_3D_P2_wts[] = {
    Dup31(.25)
};
static double QUAD_3D_P2_pts[Length(QUAD_3D_P2_wts) * 4] = {
    /* (5. - sqrt(5.)) / 20, (5. + 3 * sqrt(5.)) / 20 */
    Perm31(.13819660112501051517954131656343619)
};
QUAD QUAD_3D_P2_ = {
    "3D P2",			/* name */
    3,				/* dim */
    2,				/* order */
    Length(QUAD_3D_P2_wts),	/* npoints = 4 */
    QUAD_3D_P2_pts,		/* points */
    QUAD_3D_P2_wts,		/* weights */
    -1				/* id */
};

#if 0
static double QUAD_3D_P3_wts[] = {
    Dup31(1./40.),
    Dup31(9./40.)
};
static double QUAD_3D_P3_pts[Length(QUAD_3D_P3_wts) * 4] = {
    Perm31(0., 1.),
    Perm31(1./3., 0.)
};
#else
static double QUAD_3D_P3_wts[] = {
    /* 1 / 8 + sqrt((1715161837 - 406006699 * sqrt(17)) / 23101) / 3120 */
    Dup31(.13852796651186214232361769837564129),
    /* 1 / 8 - sqrt((1715161837 - 406006699 * sqrt(17)) / 23101) / 3120 */
    Dup31(.11147203348813785767638230162435871)
};
static double QUAD_3D_P3_pts[Length(QUAD_3D_P3_wts) * 4] = {
    /* (55 - 3 * sqrt(17) + sqrt(1022 - 134 * sqrt(17))) / 196 */
    Perm31(.32805469671142664733580581998119743),
    /* (55 - 3 * sqrt(17) - sqrt(1022 - 134 * sqrt(17))) / 196 */
    Perm31(.10695227393293068277170204157061650)
};
#endif
QUAD QUAD_3D_P3_ = {
    "3D P3",			/* name */
    3,				/* dim */
    3,				/* order */
    Length(QUAD_3D_P3_wts),	/* npoints = 8 */
    QUAD_3D_P3_pts,		/* points */
    QUAD_3D_P3_wts,		/* weights */
    -1				/* id */
};

#if 0
static double QUAD_3D_P4_wts[] = {
    Dup4(-148./1875.),	/* negative weight */
    Dup31(343./7500.),
    Dup22(56./375.)
};
static double QUAD_3D_P4_pts[Length(QUAD_3D_P4_wts) * 4] = {
    Perm4(0.25),
    Perm31(1./14.),
    Perm22(0.1005964238332008)
};
QUAD QUAD_3D_P4_ = {
    "3D P4",			/* name */
    3,				/* dim */
    4,				/* order */
    11,				/* npoints = 11 */
    QUAD_3D_P4_pts,		/* points */
    QUAD_3D_P4_wts,		/* weights */
    -1				/* id */
};
#else
static double QUAD_3D_P4_wts[] = {
    Dup31(.07349304311636194934358694586367885),
    Dup31(.11268792571801585036501492847638892),
    Dup22(.04254602077708146686093208377328816)
};
static double QUAD_3D_P4_pts[Length(QUAD_3D_P4_wts) * 4] = {
    Perm31(.09273525031089122628655892066032137),
    Perm31(.31088591926330060975814749494040332),
    Perm22(.04550370412564965000000000000000000)
};
QUAD QUAD_3D_P4_ = {
    "3D P4",			/* name */
    3,				/* dim */
    4,				/* order */
    Length(QUAD_3D_P4_wts),	/* npoints = 14 */
    QUAD_3D_P4_pts,		/* points */
    QUAD_3D_P4_wts,		/* weights */
    -1				/* id */
};
#endif

#if 0
/* Stroud T3:5-1 p315 */
static double QUAD_3D_P5_wts[] = {
    Dup4(16./135.),
    /* (2665 + 14 * sqrt(15)) / 37800 */
    Dup31(.07193708377901862),
    /* (2665 - 14 * sqrt(15)) / 37800 */
    Dup31(.06906820722627239),
    Dup22(20./378.)
};
static double QUAD_3D_P5_pts[Length(QUAD_3D_P5_wts) * 4] = {
    Perm4(.25),
    /* (7 - sqrt(15)) / 34, (13 + 3 * sqrt(15)) / 34 */
    Perm31(.09197107805272303),
    /* (7 + sqrt(15)) / 34, (13 - 3 * sqrt(15)) / 34 */
    Perm31(.31979362782962991),
    /* (10 - 2 * sqrt(15)) / 40, (10 + 2 * sqrt(15)) / 40 */
    Perm22(.05635083268962916)
};
QUAD QUAD_3D_P5_ = {
    "3D P5",			/* name */
    3,				/* dim */
    5,				/* order */
    15,				/* npoints = 15 */
    QUAD_3D_P5_pts,		/* points */
    QUAD_3D_P5_wts,		/* weights */
    -1				/* id */
};
#else
static double QUAD_3D_P5_wts[] = {
    Dup31(.11268792571801585079918565233328633),
    Dup31(.07349304311636194954371020548632750),
    Dup22(.04254602077708146643806942812025744)

};
static double QUAD_3D_P5_pts[Length(QUAD_3D_P5_wts) * 4] = {
    Perm31(.31088591926330060979734573376345783),
    Perm31(.09273525031089122640232391373703061),
    Perm22(.04550370412564964949188052627933943)
};
QUAD QUAD_3D_P5_ = {
    "3D P5",			/* name */
    3,				/* dim */
    5,				/* order */
    Length(QUAD_3D_P5_wts),	/* npoints = 14 */
    QUAD_3D_P5_pts,		/* points */
    QUAD_3D_P5_wts,		/* weights */
    -1				/* id */
};
#endif

static double QUAD_3D_P6_wts[] = {
    Dup31(.03992275025816749209969062755747998),
    Dup31(.01007721105532064294801323744593686),
    Dup31(.05535718154365472209515327785372602),
    Dup211(27./560.)
};
static double QUAD_3D_P6_pts[Length(QUAD_3D_P6_wts) * 4] = {
    Perm31(.21460287125915202928883921938628499),
    Perm31(.04067395853461135311557944895641006),
    Perm31(.32233789014227551034399447076249213),
    /* (3 - sqrt(5)) / 12, (5 + sqrt(5)) / 12, (1 + sqrt(5)) / 12 */
    Perm211(.06366100187501752529923552760572698,
	    .60300566479164914136743113906093969)
};
QUAD QUAD_3D_P6_ = {
    "3D P6",			/* name */
    3,				/* dim */
    6,				/* order */
    Length(QUAD_3D_P6_wts),	/* npoints = 24 */
    QUAD_3D_P6_pts,		/* points */
    QUAD_3D_P6_wts,		/* weights */
    -1				/* id */
};

static double QUAD_3D_P7_wts[] = {
    Dup4(.09548528946413084886057843611722638),
    Dup31(.04232958120996702907628617079854674),
    Dup22(.03189692783285757993427482408294246),
    Dup211(.03720713072833462136961556119148112),
    Dup211(.00811077082990334156610343349109654)
};
static double QUAD_3D_P7_pts[Length(QUAD_3D_P7_wts) * 4] = {
    Perm4(.25),
    Perm31(.31570114977820279942342999959331149),
    Perm22(.05048982259839636876305382298656247),
    Perm211(.18883383102600104773643110385458576,
	    .57517163758700002348324157702230752),
    Perm211(.02126547254148324598883610149981994,
	    .81083024109854856111810537984823239)
};
QUAD QUAD_3D_P7_ = {
    "3D P7",                    /* name */
    3,                          /* dim */
    7,                          /* order */
    Length(QUAD_3D_P7_wts),     /* npoints = 35 */
    QUAD_3D_P7_pts,             /* points */
    QUAD_3D_P7_wts,             /* weights */
    -1                          /* id */
};

static double QUAD_3D_P8_wts[] = {
    Dup31(.00639714777990232132145142033517302),
    Dup31(.04019044802096617248816115847981783),
    Dup31(.02430797550477032117486910877192260),
    Dup31(.05485889241369744046692412399039144),
    Dup22(.03571961223409918246495096899661762),
    Dup211(.00718319069785253940945110521980376),
    Dup211(.01637218194531911754093813975611913)
};
static double QUAD_3D_P8_pts[Length(QUAD_3D_P8_wts) * 4] = {
    Perm31(.03967542307038990126507132953938949),
    Perm31(.31448780069809631378416056269714830),
    Perm31(.10198669306270330000000000000000000),
    Perm31(.18420369694919151227594641734890918),
    Perm22(.06343628775453989240514123870189827),
    Perm211(.02169016206772800480266248262493018,
	    .71993192203946593588943495335273478),
    Perm211(.20448008063679571424133557487274534,
	    .58057719012880922417539817139062041)
};
QUAD QUAD_3D_P8_ = {
    "3D P8",			/* name */
    3,				/* dim */
    8,				/* order */
    Length(QUAD_3D_P8_wts),	/* npoints = 46 */
    QUAD_3D_P8_pts,		/* points */
    QUAD_3D_P8_wts,		/* weights */
    -1				/* id */
};

static double QUAD_3D_P9_wts[] = {
    Dup4(.05489853459364812686895885032391298),
    Dup31(.00421825735654367356185795185819147),
    Dup31(.02348412311384798927791501022996111),
    Dup31(.00421283454980389148648831814037819),
    Dup31(.02994712640542812769203037546126163),
    Dup22(.03695441750679136335292416138761121),
    Dup211(.00817349224171051348425319650294732),
    Dup211(.00987978656102278957913113314297149),
    Dup211(.02160718741919244401497646690335203)
};
static double QUAD_3D_P9_pts[Length(QUAD_3D_P9_wts) * 4] = {
    Perm4(.25000000000000000000000000000000000),
    Perm31(.03785502061999503609086515586175707),
    Perm31(.16954439965012220000000000000000000),
    Perm31(.05484140424416689000000000000000000),
    Perm31(.32229717190921058836777748445908171),
    Perm22(.10961777508972033704050355954365052),
    Perm211(.45915766038590539763886410168178216,.08004485927247373376034330857923567),
    Perm211(.03296694775357210169727386483414899,.71879584022434055051132299796383374),
    Perm211(.18174359672117481549870278661377760,.60023700739524674102301240348069459)
};
QUAD QUAD_3D_P9_ = {
    "3D P9",			/* name */
    3,				/* dim */
    9,				/* order */
    Length(QUAD_3D_P9_wts),	/* npoints = 59 */
    QUAD_3D_P9_pts,		/* points */
    QUAD_3D_P9_wts,		/* weights */
    -1				/* id */
};

static double QUAD_3D_P10_wts[] = {
    Dup4(.04574189830483037077884770618329337),
    Dup31(.01092727610912416907498417206565671),
    Dup31(.00055352334192264689534558564012282),
    Dup31(.02569337913913269580782688316792080),
    Dup22(.00055387649657283109312967562590035),
    Dup211(.01044842402938294329072628200105773),
    Dup211(.02513844602651287118280517785487423),
    Dup211(.01178620679249594711782155323755017),
    Dup211(.01332022473886650471019828463616468),
    Dup211(.00615987577565961666092767531756180)
};
static double QUAD_3D_P10_pts[Length(QUAD_3D_P10_wts) * 4] = {
    Perm4(.25000000000000000000000000000000000),
    Perm31(.11425191803006935688146412277598412),
    Perm31(.01063790234539248531264164411274776),
    Perm31(.31274070833535645859816704980806110),
    Perm22(.01631296303281644000000000000000000),
    Perm211(.03430622963180452385835196582344460,.59830121060139461905983787517050400),
    Perm211(.12346418534551115945916818783743644,.47120066204746310257913700590727081),
    Perm211(.40991962933181117418479812480531207,.16546413290740130923509687990363569),
    Perm211(.17397243903011716743177479785668929,.62916375300275643773181882027844514),
    Perm211(.03002157005631784150255786784038011,.81213056814351208262160080755918730)
};
QUAD QUAD_3D_P10_ = {
    "3D P10",			/* name */
    3,				/* dim */
    10,				/* order */
    Length(QUAD_3D_P10_wts),	/* npoints = 79 */
    QUAD_3D_P10_pts,		/* points */
    QUAD_3D_P10_wts,		/* weights */
    -1				/* id */
};

static double QUAD_3D_P11_wts[] = {
    Dup31(.01612698613577620369120244222737879),
    Dup31(.00178872341812357138976990346996962),
    Dup31(.00847529348343123401863799968389086),
    Dup31(.01238021263944669050859562763135516),
    Dup31(.02205586697199415746140963638568037),
    Dup31(.02295765467664274421265594265203307),
    Dup22(.00120553827014535727045055662252294),
    Dup22(.02479381575164443454447803302296997),
    Dup211(.01203878836480353606935457416590660),
    Dup211(.00189370204498242146248858917618493),
    Dup211(.01838752922255814184581020943433469),
    Dup211(.00375249249801662461193260176157591),
    Dup211(.00633289841693951300885921328914879)
};
static double QUAD_3D_P11_pts[Length(QUAD_3D_P11_wts) * 4] = {
    Perm31(.12460560449278830000000000000000000),
    Perm31(.02609630765687464746851542316261877),
    Perm31(.07193883255798884087330011042809557),
    Perm31(.32611122454203676937273102302894204),
    Perm31(.29405882789858127213310307732130217),
    Perm31(.19271399104965490000000000000000000),
    Perm22(.00047127204692773946587837159205225),
    Perm22(.10321360207480949336085123341390539),
    Perm211(.04349989920159741251267172033621503,.63045319723555591476353398203997141),
    Perm211(.01414839289422299290755441603794058,.82491678632147090000000000000000000),
    Perm211(.21646077368258425486341884576246642,.52711130286496480000000000000000000),
    Perm211(.13301884366834711587538262083530116,.73318551371398651551736762818473584),
    Perm211(.44054756810613723082959230959880706,.11506799584377921703650823955291194)
};
QUAD QUAD_3D_P11_ = {
    "3D P11",			/* name */
    3,				/* dim */
    11,				/* order */
    Length(QUAD_3D_P11_wts),	/* npoints = 96 */
    QUAD_3D_P11_pts,		/* points */
    QUAD_3D_P11_wts,		/* weights */
    -1				/* id */
};

#if 0
/* This rule has smaller smallest weight, but larger smallest coordinate */
static double QUAD_3D_P12_wts[] = {
    Dup4(.02589965672379885946221733044466074),
    Dup31(.01188011778542489263304669307765255),
    Dup31(.00019243842802940139599667156916414),
    Dup31(.01460564220714648400941139428792250),
    Dup31(.02353236994618624831565909171056252),
    Dup31(.00346404243764658661894167546736912),
    Dup31(.00228568518874660364931057482041380),
    Dup22(.00501950062495183938689269420528004),
    Dup211(.00320174248310251480919195429036897),
    Dup211(.00202024177312536986954908485107823),
    Dup211(.01899921243817155551496634864579523),
    Dup211(.01117477555012353260111605364799274),
    Dup211(.00207779882840923556600240825180423),
    Dup211(.00869161875227804588294414185879858),
    Dup1111(.00692322823546859111673842508505270)
};
static double QUAD_3D_P12_pts[Length(QUAD_3D_P12_wts) * 4] = {
    Perm4(.25000000000000000000000000000000000),
    Perm31(.19116879305510430000000000000000000),
    Perm31(.00682229647466825300000000000000000),
    Perm31(.11103797219861743807174062535414434),
    Perm31(.30431537393096840008351569498769254),
    Perm31(.33330701922933059830641111348885293),
    Perm31(.03749731365321851391723610755748038),
    Perm22(.02908058522435483091440010450122699),
    Perm211(.10629116753733978623182625071275481,.77130194925321140000000000000000000),
    Perm211(.01502748327185297263655744616273496,.65443537701179976723333225063505233),
    Perm211(.11858644579813568530889450851753765,.47382134604605374894284625141111954),
    Perm211(.23794356469277477534447903853264153,.49612597976538932876414383840091269),
    Perm211(.01843178364329910061032558678799065,.83375846651196750385382238298017745),
    Perm211(.42701814417313713339071532305024250,.12504688768243536523870060457848538),
    Perm1111(.64187643174850151718866301627283112,.24168463603891561876101692273289702,.09328358047945690018548146926510585)
};
QUAD QUAD_3D_P12_ = {
    "3D P12",			/* name */
    3,				/* dim */
    12,				/* order */
    Length(QUAD_3D_P12_wts),	/* npoints = 127 */
    QUAD_3D_P12_pts,		/* points */
    QUAD_3D_P12_wts,		/* weights */
    -1				/* id */
};
#else
/* This rule has larger smallest weight, but smaller smallest coordinate */
static double QUAD_3D_P12_wts[] = {
    Dup4(.02340581914868067999082580773836836),
    Dup31(.00484469946470415656870798306091558),
    Dup31(.00079865303812732982185563521014343),
    Dup31(.01311872008808756207964488505025527),
    Dup31(.02352182961292765917274505054313770),
    Dup31(.00210860882494149803857437048649497),
    Dup31(.00047839298963616600187228601742259),
    Dup22(.00204546234216855322941711800170502),
    Dup211(.00334576331671817115245418532677178),
    Dup211(.01181044822479275264785338274950585),
    Dup211(.00290156990282342152841364375092118),
    Dup211(.00949250645501753676094846901252898),
    Dup211(.02094018358085748583183796760479700),
    Dup211(.00171435866337409051521874943702732),
    Dup1111(.00759915954173370886076474450830409)
};
static double QUAD_3D_P12_pts[Length(QUAD_3D_P12_wts) * 4] = {
    Perm4(.25000000000000000000000000000000000),
    Perm31(.19318721110347230000000000000000000),
    Perm31(.01811701371436566878506928822499717),
    Perm31(.10700751831426066518406159227423033),
    Perm31(.29936173715970702940603127680004538),
    Perm31(.33333033333333333042835213613025030),
    Perm31(.16575369007421640000000000000000000),
    Perm22(.04009986052352575650366980228640728),
    Perm211(.01951844463761131301132122485607343,.59982639757597731668263005976738196),
    Perm211(.24970741896308715787490891769354198,.47400425629911050000000000000000000),
    Perm211(.07674205857869954726322831328843659,.83056291375422969598432041821082569),
    Perm211(.43011409627915217536723647418133112,.02265922072588833582931396831630072),
    Perm211(.12197854304894211937147375564906792,.47765370899783134571567376444973682),
    Perm211(.01480482319031682427540691439704854,.81083799468092699988474915243749073),
    Perm1111(.65250697573013212016385330106711095,.22646235632397177636617160407210034,.02251830769546778956654013747639605)
};
QUAD QUAD_3D_P12_ = {
    "3D P12",			/* name */
    3,				/* dim */
    12,				/* order */
    Length(QUAD_3D_P12_wts),	/* npoints = 127 */
    QUAD_3D_P12_pts,		/* points */
    QUAD_3D_P12_wts,		/* weights */
    -1				/* id */
};
#endif

static double QUAD_3D_P13_wts[] = {
    Dup4(.02191579945212728678229670892998658),
    Dup31(.00809592740005652573580359966615063),
    Dup31(.00130319185047278813746994806952476),
    Dup31(.01996610676014222116016391561580003),
    Dup31(.02125705756007566772097136088386650),
    Dup22(.00077331890737182713690269661719116),
    Dup22(.01755491389570430512641028370006205),
    Dup211(.00213830361001659899343287397434178),
    Dup211(.00256560169283338620814651902766716),
    Dup211(.00338953948455728203040932651810398),
    Dup211(.01135828330503278417235563981454793),
    Dup211(.01103203882197761043040360052454856),
    Dup211(.00457602573785952356043458354199517),
    Dup211(.00827343104220868129752243222682095),
    Dup211(.00586641165391940007076312979369247),
    Dup1111(.00313458521939849614410720196518793)
};
static double QUAD_3D_P13_pts[Length(QUAD_3D_P13_wts) * 4] = {
    Perm4(.25000000000000000000000000000000000),
    Perm31(.09935339765028269917868020572165369),
    Perm31(.02361873260499568532036302265004401),
    Perm31(.30089166537572662790706731844610997),
    Perm31(.18156624280757148139366685840064601),
    Perm22(.00428160639152879988718710754508354),
    Perm22(.12290357421888442998582785890620434),
    Perm211(.28318219770202728236417353077594322,.43037955664247500440987356786807501),
    Perm211(.02239485904524970717572425710098278,.83488749018470024820940398932904512),
    Perm211(.02191788402113435132324662419880111,.67691762094326571059673391273529166),
    Perm211(.21481417044274656673534260788169227,.52280311286258745560867693994038579),
    Perm211(.08000490008644308882018405418010744,.24689045570275147370034631014113188),
    Perm211(.11579466150271899371721034492503850,.74997281767443310000000000000000000),
    Perm211(.39129315347000474438672195978809687,.18835457382799180000000000000000000),
    Perm211(.45315745821242834581317282468854978,.02202033169457796534173826092007299),
    Perm1111(.27324999892429634023602493512400674,.60775441245653315696274741541102470,.00561877924700169073874366184065955)
};
QUAD QUAD_3D_P13_ = {
    "3D P13",			/* name */
    3,				/* dim */
    13,				/* order */
    Length(QUAD_3D_P13_wts),	/* npoints = 149 */
    QUAD_3D_P13_pts,		/* points */
    QUAD_3D_P13_wts,		/* weights */
    -1				/* id */
};

static double QUAD_3D_P14_wts[] = {
    Dup31(.00898427322254918127543126682598773),
    Dup31(.00235414897468188299910869230818368),
    Dup31(.00733553866836377016223467789336265),
    Dup31(.00360629336228634011530354432318077),
    Dup31(.00022796656022189240650071390651338),
    Dup22(.00425068731230945391542573203967906),
    Dup211(.00502229674184657212637707578731437),
    Dup211(.00664105199619194276141547967835717),
    Dup211(.00648663075652078221084713724389357),
    Dup211(.01084924609520658118048627917429636),
    Dup211(.00698225572400728567899793615355807),
    Dup211(.01057643198113441258335538488635301),
    Dup211(.00172517387494940531214061228255136),
    Dup211(.01064026039260234415487304925754523),
    Dup211(.00031627239419231128593612508289817),
    Dup211(.00676212093730203740266276007684025),
    Dup1111(.00293371746826111669254642316791922),
    Dup1111(.00091803679200083798695474146748587)
};
static double QUAD_3D_P14_pts[Length(QUAD_3D_P14_wts) * 4] = {
    Perm31(.12703434587701869604797950660749487),
    Perm31(.03716308713428675181759859706979325),
    Perm31(.30931161817607732544635505822019770),
    Perm31(.07778813507287403019691221965639750),
    Perm31(.01187611663683786502091234677477106),
    Perm22(.02371189715571358237825633505545476),
    Perm211(.04551422172971295738029708158398140,.73884882267833978290969755547076243),
    Perm211(.19457055431059420000000000000000000,.36138202354403612356128050094846106),
    Perm211(.42158193164647035846631052119479790,.13481021809330111977392354242291205),
    Perm211(.36227661803202431683389679069549247,.09100846759454444774082592541447308),
    Perm211(.26662003783461096351186917353420086,.45135951603290056428206454329600320),
    Perm211(.07870367664603755989163074150395650,.53854007868617855365162509332690316),
    Perm211(.01462604843949452202375023818416595,.68140642280720592407050422036244765),
    Perm211(.20755902173331721318141636044536441,.49641284136813420000000000000000000),
    Perm211(.00317672566580133046838579859910808,.88571644680187933415518991697343211),
    Perm211(.16634658949265576428233847556684871,.64221464654291632524678940601354742),
    Perm1111(.59698804897542365623933181080626979,.30344194369885264264500117734906354,.00772105989990930297678960227638472),
    Perm1111(.81379652801439184798325669233364806,.06021328978843793059084645285790579,.12582571438467239382589793638340901)
};
QUAD QUAD_3D_P14_ = {
    "3D P14",			/* name */
    3,				/* dim */
    14,				/* order */
    Length(QUAD_3D_P14_wts),	/* npoints = 194 */
    QUAD_3D_P14_pts,		/* points */
    QUAD_3D_P14_wts,		/* weights */
    -1				/* id */
};

/*------------------ functions computing order of a basis -------------------*/

#if 1
# define BasisOrder(u, e, i) (!DofIsHP(u) ? (u)->type->order : \
	(u)->hp->info->types[(u)->hp->elem_order[e->index]]->order)
#else	/* 0|1 */
#endif	/* 0|1 */


/*---------------- functions managing caches and quad_list ------------------*/

static QUAD **quad_list = NULL;
static size_t quad_list_count = 0, quad_list_allocated = 0;

void
phgQuadReset(void)
{
    int i;

    /* Free quad_list entries */
    for (i = 0; i < quad_list_count; i++) {
	quad_list[i]->id = -1;
    }
    phgFree(quad_list);
    quad_list = NULL;
    quad_list_count = quad_list_allocated = 0;

    /* The calls below will free dynamically generated quadrature rules */
    phgQuadGetQuad1D(-1);
    phgQuadGetQuad2D(-1);
    phgQuadGetQuad3D(-1);
}
