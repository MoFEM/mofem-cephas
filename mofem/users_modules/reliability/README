#####################################################################
#                                                                   #
#                      Commands                                     #
#                                                                   #
#####################################################################

////////////////////////////////////
//
// 1. Homogenisation - deterministic
//
////////////////////////////////////

mpirun -np 1 ./rve_mechanical \
-my_file ~/mofem_installation/mofem-cephas/mofem/users_modules/homogenisation/meshes/RVE_UD.cub \
-ksp_type fgmres -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor \
-my_order 1 -my_bc_type periodic


mpirun -np 1 ./rve_fibre_directions \
-my_file ~/mofem_installation/mofem-cephas/mofem/users_modules/homogenisation/meshes/Cube_RVE_with_reinforcement.cub \
-ksp_type fgmres -pc_type lu -pc_factor_mat_solver_package superlu_dist -ksp_monitor \
-my_order 1

mpirun -np 1 ./rve_mechanical \
-my_file solution_RVE.h5m \
-ksp_type fgmres -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor \
-my_order 1 -my_bc_type periodic


////////////////////////////////////
//
// 2. Homogenisation - stochastic
//
////////////////////////////////////

mpirun -np 1 ./psfe_rve_mechanical \
-my_file ~/mofem_installation/mofem-cephas/mofem/users_modules/homogenisation/meshes/Cube.cub \
-ksp_type fgmres -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor \
-my_order 1 -my_bc_type periodic


mpirun -np 1 ../homogenisation/rve_fibre_directions \
-my_file ~/mofem_installation/mofem-cephas/mofem/users_modules/homogenisation/meshes/Cube_RVE_with_reinforcement.cub \
-ksp_type fgmres -pc_type lu -pc_factor_mat_solver_package superlu_dist -ksp_monitor \
-my_order 1

mpirun -np 1 ./psfe_rve_mechanical \
-my_file solution_RVE.h5m \
-ksp_type fgmres -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor \
-my_order 1 -my_bc_type periodic


////////////////////////////////////
//
// 2. Homogenisation - stochastic
//
////////////////////////////////////

-my_file ~/mofem_installation/mofem-cephas/mofem/users_modules/reliability/meshes/RVE_UD.cub \
-my_file ~/mofem_installation/mofem-cephas/mofem/users_modules/homogenisation/meshes/Cube_RVE_with_reinforcement.cub \

# Step 1: potential flow calculation to identify fibre direction
mpirun -np 1 ../homogenisation/rve_fibre_directions \
-my_file ~/mofem_installation/mofem-cephas/mofem/users_modules/reliability/meshes/RVE_UD.cub \
-ksp_type fgmres -pc_type lu \
-pc_factor_mat_solver_package superlu_dist -ksp_monitor \
-my_order 1 

# Step 2: RVE homogenisation calculation & structural level FE

# Case 1: Linear displacement
make trans_iso_RVE_disp_7vars && \
mpirun -np 1 ./trans_iso_RVE_disp_7vars \
-my_file solution_RVE.h5m \
-ksp_type fgmres -pc_type lu \
-pc_factor_mat_solver_package mumps -ksp_monitor -my_order 1 \
-myapplied_strain 1.0,0.0,0.0,0.0,0.0,0.0 \
-log_summary


# Case 2: Periodic
make trans_iso_RVE_Periodic_7vars && \
mpirun -np 1 ./trans_iso_RVE_Periodic_7vars \
-my_file solution_RVE.h5m \
-ksp_type fgmres -pc_type lu \
-pc_factor_mat_solver_package mumps -ksp_monitor -my_order 1 \ 
-myapplied_strain 1.0,0.0,0.0,0.0,0.0,0.0

# Case 3: Constant traction
make trans_iso_RVE_Traction_7vars && \
mpirun -np 1 ./trans_iso_RVE_Traction_7vars \
-my_file solution_RVE.h5m \
-ksp_type fgmres -pc_type lu \
-pc_factor_mat_solver_package mumps -ksp_monitor -my_order 1 \
-myapplied_strain 1.0,0.0,0.0,0.0,0.0,0.0


******************************************************************************************
*                                                                                        *
* Example run CompStruct_Rel for performing reliability analysis                         *
*  (1) First-Order Reliability Method with improved Hasofer Lind - Rackwitz Fiessler     *
*      (iHL-RLF) algorithm                                                               *
*                                                                                        *
******************************************************************************************


# ----------------------------------------------------
# Case 2: multiple layers laminate (up to four layers)
# Reliability calculated by FORM method
# ----------------------------------------------------
WWFE_Laminate_Type_3n.cub

valgrind --track-origins=yes \


../valgrind --track-origins=yes \

make MsFE_Reliability_Laminate_FORM_Disp && \
mpirun -np 1 \
./MsFE_Reliability_Laminate_FORM_Disp \
-my_file_macro ~/mofem_installation/mofem-cephas/mofem/users_modules/reliability/meshes/Laminate_REL_1L_Fine.cub \
-my_prob_data_file ~/Dropbox/DURACOMP_Cal/009_MoFEM/04_ReliabilityAnalysis/Input_probdata_CFRP_Ply_4_vars.txt \
-my_file_RVE solution_RVE.h5m \
-ksp_type fgmres -pc_type lu \
-pc_factor_mat_solver_package mumps -ksp_monitor \
-my_order_RVE 1 -my_order_Macro 1 -my_NO_Layers 1 
\
-malloc_debug -malloc_dump



