{% extends "page.html" %}
{% if announcement_login %}
{% set announcement = announcement_login %}
{% endif %}

{% block login_widget %}
{% endblock %}

{% block main %}

<style>
  .aligncenter {
    text-align: center;
  }
</style>

<p class="aligncenter">
  <img src="http://mofem.eng.gla.ac.uk/mofem/html/mofem_logo.png" alt="MoFEM logo" style="width:409px;height:90px;" />
</p>
<h1 style="font-weight:200;font-size:150%">
  <center>An open source, parallel finite element library</center>
</h1>

<style>
  .notes {
    text-align: left;
    width: 50%;
    margin-left: auto;
    margin-right: auto;
    padding-top: 15px;
  }
</style>

<div class="notes">

  <h3 id="password-and-login">Password and login</h3>
  <ul>
    <li>On the first login, select the password</li>
    <li>The shell password on the SSH login is different than the JupyterHub password</li>
    <li>Ask admin for SSH password </li>
    <li>Change password in the shell using <a href="https://man7.org/linux/man-pages/man1/passwd.1.html">passwd</a>
      command</li>
    <li>Set up your shell with the command (e.g. bash):
      <pre><code>$ usermod <span class="hljs-comment">--shell /bin/bash your_login_name</span>
Entry <span class="hljs-keyword">in</span> .ssh/config <span class="hljs-keyword">on</span> laptop/desktop
</code></pre>
    </li>
  </ul>
  <h3 id="ssh-config">SSH config</h3>
  <p>Copy the following code into .ssh/config on your laptop or desktop. </p>
  <pre><code>Host mofemhub
HostName cactus<span class="hljs-selector-class">.eng</span><span class="hljs-selector-class">.gla</span><span class="hljs-selector-class">.ac</span><span class="hljs-selector-class">.uk</span>
ForwardX11 yes
Compression yes
User lukasz
Port <span class="hljs-number">222</span>
</code></pre>

</div>

{% block login %}
<div id="login-main" class="container">
  {% block login_container %}
  {% if custom_html %}
  {{ custom_html | safe }}
  {% elif login_service %}
  <div class="service-login">
    <p id='insecure-login-warning' class='hidden'>
      Warning: JupyterHub seems to be served over an unsecured HTTP connection.
      We strongly recommend enabling HTTPS for JupyterHub.
    </p>

    <a role="button" class='btn btn-jupyter btn-lg' href='{{authenticator_login_url}}'>
      Sign in with {{login_service}}
    </a>
  </div>
  {% else %}
  <form action="{{authenticator_login_url}}" method="post" role="form">
    <div class="auth-form-header">
      Sign in
    </div>
    <div class='auth-form-body'>

      {% if login_error %}
      <p class="login_error">
        {{login_error}}
      </p>
      {% endif %}
      <label for="username_input">Username:</label>
      <input id="username_input" type="text" autocapitalize="off" autocorrect="off" class="form-control" name="username"
        val="{{username}}" tabindex="1" autofocus="autofocus" />
      <label for='password_input'>Password:</label>
      <input type="password" class="form-control" name="password" id="password_input" tabindex="2" />

      <div class="feedback-container">
        <input id="login_submit" type="submit" class='btn btn-jupyter' value='Sign in' tabindex="3" />
        <div class="feedback-widget hidden">
          <i class="fa fa-spinner"></i>
        </div>
      </div>

      {% block login_terms %}
      {% if login_term_url %}
      <div id="login_terms" class="login_terms">
        <input type="checkbox" id="login_terms_checkbox" name="login_terms_checkbox" required />
        {% block login_terms_text %} {# allow overriding the text #}
        By logging into the platform you accept the <a href="{{ login_term_url }}">terms and conditions</a>.
        {% endblock login_terms_text %}
      </div>
      {% endif %}
      {% endblock login_terms %}

    </div>
  </form>
  {% endif %}
  {% endblock login_container %}
</div>
{% endblock login %}

{% endblock %}

{% block script %}
{{ super() }}
<script>
  if (window.location.protocol === "http:") {
    // unhide http warning
    var warning = document.getElementById('insecure-login-warning');
    warning.className = warning.className.replace(/\bhidden\b/, '');
  }
  // setup onSubmit feedback
  $('form').submit((e) => {
    var form = $(e.target);
    form.find('.feedback-container>input').attr('disabled', true);
    form.find('.feedback-container>*').toggleClass('hidden');
    form.find('.feedback-widget>*').toggleClass('fa-pulse');
  });
</script>
{% endblock %}